<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Ø£Ù†Ø´Ø¦ Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„ØªÙƒ Ù…Ø¬Ø§Ù†Ø§Ù‹ | Ø¹ÙØ¯Ù‘Ø©</title>
  <meta name="description" content="Ø£Ø¯Ø§Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©. Ø£Ø¶Ù Ø§Ù„Ø£Ø´Ø®Ø§Øµ ÙˆØ§Ù„Ø¹Ù„Ø§Ù‚Ø§ØªØŒ Ø§Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±ØŒ ÙˆØµØ¯Ù‘Ø± Ø§Ù„Ø´Ø¬Ø±Ø© ÙƒØµÙˆØ±Ø© Ø£Ùˆ PDF.">
  <meta name="keywords" content="Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©ØŒ Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„Ø©ØŒ Ù†Ø³Ø¨ØŒ Ø³Ù„Ø§Ù„Ø©ØŒ Ø£Ù†Ø³Ø§Ø¨ØŒ Ø¹Ù„Ø§Ù‚Ø§Øª Ø¹Ø§Ø¦Ù„ÙŠØ©ØŒ family tree">
  <meta name="author" content="Udda">
  <meta name="robots" content="index, follow">
  
  <meta property="og:type" content="website">
  <meta property="og:title" content="Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Ø£Ù†Ø´Ø¦ Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„ØªÙƒ Ù…Ø¬Ø§Ù†Ø§Ù‹ | Ø¹ÙØ¯Ù‘Ø©">
  <meta property="og:description" content="Ø£Ø¯Ø§Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©. Ø£Ø¶Ù Ø§Ù„Ø£Ø´Ø®Ø§Øµ ÙˆØ§Ù„Ø¹Ù„Ø§Ù‚Ø§ØªØŒ Ø§Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±ØŒ ÙˆØµØ¯Ù‘Ø± Ø§Ù„Ø´Ø¬Ø±Ø© ÙƒØµÙˆØ±Ø© Ø£Ùˆ PDF.">
  <meta property="og:url" content="https://udda.tools/ar/tools/family-tree.html">
  <meta property="og:site_name" content="Ø¹ÙØ¯Ù‘Ø©">
  <meta property="og:locale" content="ar_SA">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© - Ø£Ù†Ø´Ø¦ Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„ØªÙƒ Ù…Ø¬Ø§Ù†Ø§Ù‹ | Ø¹ÙØ¯Ù‘Ø©">
  <meta name="twitter:description" content="Ø£Ø¯Ø§Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©. Ø£Ø¶Ù Ø§Ù„Ø£Ø´Ø®Ø§Øµ ÙˆØ§Ù„Ø¹Ù„Ø§Ù‚Ø§ØªØŒ Ø§Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±ØŒ ÙˆØµØ¯Ù‘Ø± Ø§Ù„Ø´Ø¬Ø±Ø© ÙƒØµÙˆØ±Ø© Ø£Ùˆ PDF.">
  
  <link rel="alternate" hreflang="ar" href="https://udda.tools/ar/tools/family-tree.html">
  <link rel="alternate" hreflang="en" href="https://udda.tools/en/tools/family-tree.html">
  <link rel="alternate" hreflang="x-default" href="https://udda.tools/ar/tools/family-tree.html">
  <link rel="canonical" href="https://udda.tools/ar/tools/family-tree.html">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/main.css">
  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©",
    "description": "Ø£Ø¯Ø§Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©. Ø£Ø¶Ù Ø§Ù„Ø£Ø´Ø®Ø§Øµ ÙˆØ§Ù„Ø¹Ù„Ø§Ù‚Ø§ØªØŒ Ø§Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±ØŒ ÙˆØµØ¯Ù‘Ø± Ø§Ù„Ø´Ø¬Ø±Ø© ÙƒØµÙˆØ±Ø© Ø£Ùˆ PDF.",
    "url": "https://udda.tools/ar/tools/family-tree.html",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Any",
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
    "inLanguage": ["ar", "en"],
    "isAccessibleForFree": true
  }
  </script>
</head>
<body data-tool-id="family-tree">
  <div class="app-container">
    <div class="sidebar-overlay"></div>
    
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="../../ar/" class="logo">
          <div class="logo-icon">ğŸ”§</div>
          <span class="logo-text sidebar-text">Ø¹ÙØ¯Ù‘Ø©</span>
        </a>
      </div>
      
      <div class="sidebar-search">
        <div class="search-input-wrapper">
          <input type="text" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¯Ø§Ø©..." aria-label="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¯Ø§Ø©...">
          <svg class="search-icon" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        
        <a href="../../ar/" class="nav-item ">
          <span class="nav-item-icon">ğŸ </span>
          <span class="sidebar-text">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </a>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ§®</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø§Øª</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
            <a href="../../ar/tools/percentage.html" class="nav-item ">
              <span class="nav-item-icon">ğŸ”¢</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</span>
            </a>
            <a href="../../ar/tools/interest-calculator.html" class="nav-item ">
              <span class="nav-item-icon">ğŸ’°</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯</span>
            </a>
            <a href="../../ar/tools/loan-calculator.html" class="nav-item ">
              <span class="nav-item-icon">ğŸ¦</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù‚Ø±ÙˆØ¶</span>
            </a>
            <a href="../../ar/tools/body-calculator.html" class="nav-item ">
              <span class="nav-item-icon">âš–ï¸</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø© ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø³Ù…</span>
            </a>
            <a href="../../ar/tools/age-calculator.html" class="nav-item ">
              <span class="nav-item-icon">ğŸ‚</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…Ø±</span>
            </a>
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ”„</span>
              <span class="sidebar-text">Ù…Ø­ÙˆÙ‘Ù„Ø§Øª</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ“</span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª Ù†ØµÙŠØ©</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ“…</span>
              <span class="sidebar-text">ÙˆÙ‚Øª ÙˆØªØ§Ø±ÙŠØ®</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">âš¡</span>
              <span class="sidebar-text">Ù…ÙˆÙ„Ù‘Ø¯Ø§Øª</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ–¼ï¸</span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª ØµÙˆØ±</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ’»</span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª Ù…Ø·ÙˆØ±ÙŠÙ†</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section open">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ </span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª ÙŠÙˆÙ…ÙŠØ©</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
            <a href="../../ar/tools/family-tree.html" class="nav-item active">
              <span class="nav-item-icon">ğŸŒ³</span>
              <span class="sidebar-text">Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</span>
            </a>
          </div>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <button class="sidebar-toggle" aria-label="Toggle sidebar">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
          </svg>
          <span class="sidebar-text">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©</span>
        </button>
      </div>
    </aside>
    
    <div class="main-content">
      <header class="main-header">
        <button class="header-btn mobile-menu-btn" aria-label="Menu">
          <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
        
        <nav class="header-breadcrumb">
          <a href="../../ar/" class="breadcrumb-link">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
          <span class="breadcrumb-separator">â€º</span>
          <a href="../../ar/category/everyday.html" class="breadcrumb-link">Ø£Ø¯ÙˆØ§Øª ÙŠÙˆÙ…ÙŠØ©</a>
          <span class="breadcrumb-separator">â€º</span>
          <span class="breadcrumb-current">Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</span>
        </nav>
        
        <div class="header-actions">
          <button class="header-btn" data-favorite-btn aria-label="Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©">â˜†</button>
          <button class="header-btn" onclick="App.shareUrl('Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©')" aria-label="Ù…Ø´Ø§Ø±ÙƒØ©">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
              <polyline points="16 6 12 2 8 6"></polyline>
              <line x1="12" y1="2" x2="12" y2="15"></line>
            </svg>
          </button>
          <button class="header-btn" data-open-settings aria-label="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
          </button>
        </div>
      </header>
      
      <main class="page-content">
        <style>
:root {
  --primary: #059669;
  --primary-dark: #047857;
  --primary-light: #d1fae5;
  --male-color: #3b82f6;
  --male-light: #dbeafe;
  --female-color: #ec4899;
  --female-light: #fce7f3;
  --spouse-color: #f59e0b;
  --bg-primary: #0f172a;
  --bg-secondary: #1e293b;
  --bg-card: #334155;
  --text-primary: #f8fafc;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;
  --border-color: #475569;
}

.family-tree-app {
  min-height: 80vh;
  display: flex;
  flex-direction: column;
  font-family: inherit;
}

/* Toolbar */
.tree-toolbar {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  padding: 16px;
  background: var(--bg-secondary);
  border-radius: 12px;
  margin-bottom: 16px;
  align-items: center;
}

.toolbar-group {
  display: flex;
  gap: 4px;
  padding: 0 12px;
  border-right: 2px solid var(--border-color);
}

.toolbar-group:last-child {
  border-right: none;
}

.tool-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 10px 16px;
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  border-radius: 8px;
  color: var(--text-primary);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  font-family: inherit;
}

.tool-btn:hover {
  border-color: var(--primary);
  background: rgba(5, 150, 105, 0.1);
}

.tool-btn.primary {
  background: var(--primary);
  border-color: var(--primary);
}

.tool-btn.primary:hover {
  background: var(--primary-dark);
}

.tool-btn .icon { font-size: 1.1rem; }

/* Canvas Container */
.canvas-container {
  flex: 1;
  position: relative;
  background: var(--bg-secondary);
  border-radius: 16px;
  overflow: hidden;
  min-height: 500px;
  border: 2px solid var(--border-color);
}

.tree-canvas {
  width: 100%;
  height: 100%;
  min-height: 500px;
  cursor: grab;
  font-family: inherit;
}

.tree-canvas:active { cursor: grabbing; }

/* Empty State */
.empty-state {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  color: var(--text-muted);
}

.empty-state .icon { font-size: 4rem; margin-bottom: 16px; opacity: 0.5; }
.empty-state h3 { font-size: 1.5rem; margin-bottom: 8px; color: var(--text-secondary); }
.empty-state p { margin-bottom: 20px; }

.empty-state .start-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 14px 28px;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 12px;
  font-size: 1.1rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
  font-family: inherit;
}

.empty-state .start-btn:hover {
  background: var(--primary-dark);
  transform: scale(1.05);
}

/* SVG Text */
.tree-canvas text {
  font-family: inherit;
}

/* Modal */
.modal-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s;
}

.modal-overlay.show { opacity: 1; visibility: visible; }

.modal-content {
  background: var(--bg-secondary);
  border-radius: 20px;
  width: 90%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
  transform: scale(0.9);
  transition: transform 0.3s;
}

.modal-overlay.show .modal-content { transform: scale(1); }

.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 20px 24px;
  border-bottom: 2px solid var(--border-color);
}

.modal-header h2 {
  font-size: 1.3rem;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 10px;
}

.modal-close {
  background: none;
  border: none;
  font-size: 1.5rem;
  color: var(--text-muted);
  cursor: pointer;
  padding: 8px;
  border-radius: 8px;
}

.modal-close:hover { background: var(--bg-card); color: var(--text-primary); }

.modal-body { padding: 24px; }

.form-group { margin-bottom: 20px; }

.form-group label {
  display: block;
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 12px 16px;
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  border-radius: 10px;
  color: var(--text-primary);
  font-size: 1rem;
  font-family: inherit;
  transition: border-color 0.2s;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary);
}

.form-group textarea { min-height: 80px; resize: vertical; }

/* Gender Toggle */
.gender-toggle { display: flex; gap: 12px; }

.gender-option {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 14px;
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s;
}

.gender-option input { display: none; }

.gender-option.male:has(input:checked) {
  border-color: var(--male-color);
  background: rgba(59, 130, 246, 0.2);
}

.gender-option.female:has(input:checked) {
  border-color: var(--female-color);
  background: rgba(236, 72, 153, 0.2);
}

.gender-option .icon { font-size: 1.3rem; }
.gender-option span { font-weight: 600; }

/* Photo Upload */
.photo-upload { display: flex; align-items: center; gap: 16px; }

.photo-preview {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: var(--bg-card);
  border: 3px solid var(--border-color);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.photo-preview img { width: 100%; height: 100%; object-fit: cover; }
.photo-preview .placeholder { font-size: 2rem; color: var(--text-muted); }

.photo-buttons { display: flex; flex-direction: column; gap: 8px; }

.photo-btn {
  padding: 8px 16px;
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  border-radius: 8px;
  color: var(--text-primary);
  font-size: 0.85rem;
  cursor: pointer;
  font-family: inherit;
}

.photo-btn:hover { border-color: var(--primary); }
.photo-btn.remove { border-color: #ef4444; color: #ef4444; }

/* Relation Grid */
.relation-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}

.relation-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 12px 8px;
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s;
}

.relation-option:hover { border-color: var(--primary); }

.relation-option.selected {
  border-color: var(--primary);
  background: rgba(5, 150, 105, 0.2);
}

.relation-option.disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.relation-option .icon { font-size: 1.5rem; }
.relation-option span { font-size: 0.8rem; font-weight: 600; text-align: center; }

/* Modal Footer */
.modal-footer {
  display: flex;
  gap: 12px;
  padding: 20px 24px;
  border-top: 2px solid var(--border-color);
}

.modal-footer button {
  flex: 1;
  padding: 14px;
  border-radius: 10px;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  font-family: inherit;
}

.btn-cancel {
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  color: var(--text-primary);
}

.btn-save { background: var(--primary); border: none; color: white; }
.btn-save:hover { background: var(--primary-dark); }

.btn-delete { background: #ef4444; border: none; color: white; flex: 0.5; }
.btn-delete:hover { background: #dc2626; }

/* Zoom Controls */
.zoom-controls {
  position: absolute;
  bottom: 20px;
  left: 20px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  background: var(--bg-card);
  padding: 8px;
  border-radius: 12px;
  border: 2px solid var(--border-color);
}

.zoom-btn {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-secondary);
  border: none;
  border-radius: 8px;
  color: var(--text-primary);
  font-size: 1.2rem;
  cursor: pointer;
}

.zoom-btn:hover { background: var(--primary); }

.zoom-level {
  text-align: center;
  font-size: 0.8rem;
  color: var(--text-muted);
  padding: 4px 0;
}

/* Stats Bar */
.stats-bar {
  display: flex;
  gap: 20px;
  padding: 12px 20px;
  background: var(--bg-card);
  border-radius: 10px;
  margin-top: 16px;
  flex-wrap: wrap;
  justify-content: center;
}

.stat-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
}

.stat-item .icon { font-size: 1.1rem; }
.stat-item .label { color: var(--text-muted); }
.stat-item .value { font-weight: 700; color: var(--text-primary); }

/* Toast */
.toast {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: var(--bg-card);
  border: 2px solid var(--primary);
  padding: 16px 24px;
  border-radius: 12px;
  color: var(--text-primary);
  font-weight: 600;
  z-index: 2000;
  opacity: 0;
  transition: all 0.3s;
}

.toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

/* Dropdown */
.dropdown { position: relative; }

.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  margin-top: 8px;
  background: var(--bg-card);
  border: 2px solid var(--border-color);
  border-radius: 12px;
  min-width: 180px;
  z-index: 100;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: all 0.2s;
}

.dropdown.open .dropdown-menu {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.dropdown-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 16px;
  color: var(--text-primary);
  font-size: 0.9rem;
  cursor: pointer;
}

.dropdown-item:first-child { border-radius: 10px 10px 0 0; }
.dropdown-item:last-child { border-radius: 0 0 10px 10px; }
.dropdown-item:hover { background: var(--bg-secondary); }

.dropdown-divider { height: 1px; background: var(--border-color); margin: 4px 0; }

.hidden-input { display: none; }

@media (max-width: 768px) {
  .tree-toolbar { justify-content: center; }
  .toolbar-group { border-right: none; padding: 8px 0; width: 100%; justify-content: center; flex-wrap: wrap; }
  .tool-btn span:not(.icon) { display: none; }
  .relation-grid { grid-template-columns: repeat(2, 1fr); }
}
</style>

<div class="tool-card">
  <div class="tool-header">
    <div class="tool-icon">ğŸŒ³</div>
    <div>
      <h1 class="tool-title">Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</h1>
      <p class="tool-description">Ø£Ù†Ø´Ø¦ Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„ØªÙƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØµØ¯Ù‘Ø±Ù‡Ø§ ÙƒØµÙˆØ±Ø©</p>
    </div>
  </div>

  <div class="family-tree-app">
    <!-- Toolbar -->
    <div class="tree-toolbar">
      <div class="toolbar-group">
        <button class="tool-btn primary" onclick="addFirstPerson()" id="add-first-btn">
          <span class="icon">â•</span>
          <span>Ø¥Ø¶Ø§ÙØ© Ø´Ø®Øµ</span>
        </button>
      </div>
      
      <div class="toolbar-group">
        <button class="tool-btn" onclick="saveToLocal()">
          <span class="icon">ğŸ’¾</span>
          <span>Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ</span>
        </button>
        <button class="tool-btn" onclick="loadFromLocal()">
          <span class="icon">ğŸ“‚</span>
          <span>ØªØ­Ù…ÙŠÙ„ Ù…Ø­ÙÙˆØ¸</span>
        </button>
      </div>
      
      <div class="toolbar-group">
        <div class="dropdown" id="export-dropdown">
          <button class="tool-btn" onclick="toggleDropdown('export-dropdown')">
            <span class="icon">ğŸ“¤</span>
            <span>ØªØµØ¯ÙŠØ±</span>
          </button>
          <div class="dropdown-menu">
            <div class="dropdown-item" onclick="exportAsPNG()">ğŸ–¼ï¸ ØªØµØ¯ÙŠØ± ÙƒØµÙˆØ±Ø© PNG</div>
            <div class="dropdown-item" onclick="exportAsSVG()">ğŸ“ ØªØµØ¯ÙŠØ± ÙƒÙ€ SVG</div>
            <div class="dropdown-divider"></div>
            <div class="dropdown-item" onclick="exportAsJSON()">ğŸ“„ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
          </div>
        </div>
        <button class="tool-btn" onclick="importJSON()">
          <span class="icon">ğŸ“¥</span>
          <span>Ø§Ø³ØªÙŠØ±Ø§Ø¯</span>
        </button>
      </div>
      
      <div class="toolbar-group">
        <button class="tool-btn" onclick="clearAll()">
          <span class="icon">ğŸ—‘ï¸</span>
          <span>Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</span>
        </button>
      </div>
    </div>

    <!-- Canvas -->
    <div class="canvas-container" id="canvas-container">
      <svg class="tree-canvas" id="tree-canvas">
        <defs>
          <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
            <feDropShadow dx="0" dy="4" stdDeviation="6" flood-opacity="0.3"/>
          </filter>
        </defs>
        <g id="tree-content">
          <g id="connections-layer"></g>
          <g id="persons-layer"></g>
        </g>
      </svg>
      
      <div class="empty-state" id="empty-state">
        <div class="icon">ğŸŒ³</div>
        <h3>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø´Ø®Øµ</h3>
        <p>Ø§Ø¶ØºØ· + Ù„Ø¥Ø¶Ø§ÙØ© Ù‚Ø±ÙŠØ¨</p>
        <button class="start-btn" onclick="addFirstPerson()">
          <span>â•</span> Ø¥Ø¶Ø§ÙØ© Ø´Ø®Øµ
        </button>
      </div>
      
      <div class="zoom-controls">
        <button class="zoom-btn" onclick="zoomIn()">â•</button>
        <div class="zoom-level" id="zoom-level">100%</div>
        <button class="zoom-btn" onclick="zoomOut()">â–</button>
        <button class="zoom-btn" onclick="fitToScreen()">âŠ¡</button>
      </div>
    </div>

    <!-- Stats Bar -->
    <div class="stats-bar" id="stats-bar" style="display: none;">
      <div class="stat-item">
        <span class="icon">ğŸ‘¥</span>
        <span class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø´Ø®Ø§Øµ:</span>
        <span class="value" id="stat-total">0</span>
      </div>
      <div class="stat-item">
        <span class="icon">ğŸ‘¨</span>
        <span class="label">Ø°ÙƒÙˆØ±:</span>
        <span class="value" id="stat-males">0</span>
      </div>
      <div class="stat-item">
        <span class="icon">ğŸ‘©</span>
        <span class="label">Ø¥Ù†Ø§Ø«:</span>
        <span class="value" id="stat-females">0</span>
      </div>
      <div class="stat-item">
        <span class="icon">ğŸ“Š</span>
        <span class="label">Ø§Ù„Ø£Ø¬ÙŠØ§Ù„:</span>
        <span class="value" id="stat-generations">0</span>
      </div>
    </div>
  </div>
</div>

<!-- Person Modal -->
<div class="modal-overlay" id="person-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2><span id="modal-icon">ğŸ‘¤</span> <span id="modal-title">Ø¥Ø¶Ø§ÙØ© Ø´Ø®Øµ</span></h2>
      <button class="modal-close" onclick="closeModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group" id="relation-group" style="display: none;">
        <label>ØµÙ„Ø© Ø§Ù„Ù‚Ø±Ø§Ø¨Ø©</label>
        <div class="relation-grid" id="relation-grid"></div>
      </div>
      
      <div class="form-group">
        <label>Ø§Ù„Ø§Ø³Ù… *</label>
        <input type="text" id="person-name" required>
      </div>
      
      <div class="form-group">
        <label>Ø§Ù„Ø¬Ù†Ø³</label>
        <div class="gender-toggle">
          <label class="gender-option male">
            <input type="radio" name="gender" value="male" checked>
            <span class="icon">ğŸ‘¨</span>
            <span>Ø°ÙƒØ±</span>
          </label>
          <label class="gender-option female">
            <input type="radio" name="gender" value="female">
            <span class="icon">ğŸ‘©</span>
            <span>Ø£Ù†Ø«Ù‰</span>
          </label>
        </div>
      </div>
      
      <div class="form-group">
        <label>Ø§Ù„ØµÙˆØ±Ø©</label>
        <div class="photo-upload">
          <div class="photo-preview" id="photo-preview">
            <span class="placeholder">ğŸ‘¤</span>
          </div>
          <div class="photo-buttons">
            <button type="button" class="photo-btn" onclick="document.getElementById('photo-input').click()">
              ğŸ“· Ø±ÙØ¹ ØµÙˆØ±Ø©
            </button>
            <button type="button" class="photo-btn remove" onclick="removePhoto()" id="remove-photo-btn" style="display: none;">
              ğŸ—‘ï¸ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø©
            </button>
          </div>
        </div>
        <input type="file" id="photo-input" class="hidden-input" accept="image/*" onchange="handlePhotoUpload(event)">
      </div>
      
      <div class="form-group">
        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
        <input type="date" id="person-birth">
      </div>
      
      <div class="form-group">
        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ÙˆÙØ§Ø©</label>
        <input type="date" id="person-death">
      </div>
      
      <div class="form-group">
        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
        <textarea id="person-notes"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-delete" id="delete-btn" onclick="deletePerson()" style="display: none;">
        ğŸ—‘ï¸ Ø­Ø°Ù
      </button>
      <button class="btn-cancel" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn-save" onclick="savePerson()">Ø­ÙØ¸</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>
<input type="file" id="import-input" class="hidden-input" accept=".json" onchange="handleImport(event)">

<script>
const isArabic = document.documentElement.lang === 'ar';

// ==================== DATA STRUCTURE ====================
// Ø¨Ù†ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©: ÙƒÙ„ Ø´Ø®Øµ Ù„Ù‡ Ø£Ø¨ ÙˆØ£Ù… Ù…Ø­Ø¯Ø¯ÙŠÙ† (Ø£Ùˆ null)
// Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡ ÙŠÙØ³ØªÙ†ØªØ¬ÙˆÙ† Ù…Ù† fatherId/motherId
let familyData = {
  persons: {},
  rootId: null
};

let currentPersonId = null;
let editMode = false;
let addingRelativeTo = null;
let selectedRelation = null;
let currentPhoto = null;

// Canvas state
let zoom = 1;
let panX = 0;
let panY = 0;
let isDragging = false;
let dragStartX = 0;
let dragStartY = 0;

const CARD_W = 140;
const CARD_H = 90;
const GAP_H = 50;
const GAP_V = 70;

// Relations
const relations = [
  { id: 'father', icon: 'ğŸ‘¨', labelAr: 'Ø£Ø¨', labelEn: 'Father', gender: 'male' },
  { id: 'mother', icon: 'ğŸ‘©', labelAr: 'Ø£Ù…', labelEn: 'Mother', gender: 'female' },
  { id: 'spouse', icon: 'ğŸ’‘', labelAr: 'Ø²ÙˆØ¬/Ø©', labelEn: 'Spouse', gender: null },
  { id: 'child', icon: 'ğŸ‘¶', labelAr: 'Ø§Ø¨Ù†/Ø©', labelEn: 'Child', gender: null },
  { id: 'sibling', icon: 'ğŸ‘«', labelAr: 'Ø£Ø®/Ø£Ø®Øª', labelEn: 'Sibling', gender: null }
];

// ==================== INIT ====================
function init() {
  setupCanvas();
  buildRelationGrid();
  updateUI();
}

function setupCanvas() {
  const canvas = document.getElementById('tree-canvas');
  const container = document.getElementById('canvas-container');
  
  canvas.addEventListener('mousedown', startPan);
  canvas.addEventListener('mousemove', doPan);
  canvas.addEventListener('mouseup', endPan);
  canvas.addEventListener('mouseleave', endPan);
  container.addEventListener('wheel', handleZoom);
  
  canvas.addEventListener('touchstart', handleTouchStart, { passive: false });
  canvas.addEventListener('touchmove', handleTouchMove, { passive: false });
  canvas.addEventListener('touchend', handleTouchEnd);
}

function buildRelationGrid() {
  const grid = document.getElementById('relation-grid');
  grid.innerHTML = relations.map(r => `
    <div class="relation-option" data-relation="${r.id}" onclick="selectRelation('${r.id}')">
      <span class="icon">${r.icon}</span>
      <span>${isArabic ? r.labelAr : r.labelEn}</span>
    </div>
  `).join('');
}

// ==================== HELPERS ====================
function generateId() {
  return 'p' + Date.now() + Math.random().toString(36).substr(2, 5);
}

function getChildren(personId) {
  return Object.values(familyData.persons).filter(p => 
    p.fatherId === personId || p.motherId === personId
  );
}

function getSiblings(personId) {
  const person = familyData.persons[personId];
  if (!person) return [];
  
  return Object.values(familyData.persons).filter(p => 
    p.id !== personId && (
      (person.fatherId && p.fatherId === person.fatherId) ||
      (person.motherId && p.motherId === person.motherId)
    )
  );
}

function getSpouses(personId) {
  const person = familyData.persons[personId];
  if (!person) return [];
  return person.spouseIds.map(id => familyData.persons[id]).filter(Boolean);
}

// ==================== PERSON MANAGEMENT ====================
function addFirstPerson() {
  editMode = false;
  addingRelativeTo = null;
  selectedRelation = null;
  currentPhoto = null;
  
  document.getElementById('relation-group').style.display = 'none';
  document.getElementById('delete-btn').style.display = 'none';
  document.getElementById('modal-title').textContent = isArabic ? 'Ø¥Ø¶Ø§ÙØ© Ø´Ø®Øµ' : 'Add Person';
  document.getElementById('modal-icon').textContent = 'ğŸ‘¤';
  
  resetForm();
  openModal();
}

function addRelativeTo(personId) {
  editMode = false;
  addingRelativeTo = personId;
  selectedRelation = null;
  currentPhoto = null;
  
  const person = familyData.persons[personId];
  
  document.getElementById('relation-group').style.display = 'block';
  document.getElementById('delete-btn').style.display = 'none';
  document.getElementById('modal-title').textContent = isArabic ? 'Ø¥Ø¶Ø§ÙØ© Ù‚Ø±ÙŠØ¨' : 'Add Relative';
  document.getElementById('modal-icon').textContent = 'â•';
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
  document.querySelectorAll('.relation-option').forEach(el => {
    el.classList.remove('selected', 'disabled');
    const rel = el.dataset.relation;
    
    // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø£Ø¨ Ø¥Ø°Ø§ Ù…ÙˆØ¬ÙˆØ¯
    if (rel === 'father' && person.fatherId) {
      el.classList.add('disabled');
    }
    // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø£Ù… Ø¥Ø°Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø©
    if (rel === 'mother' && person.motherId) {
      el.classList.add('disabled');
    }
  });
  
  resetForm();
  openModal();
}

function editPerson(personId) {
  editMode = true;
  currentPersonId = personId;
  addingRelativeTo = null;
  
  const person = familyData.persons[personId];
  if (!person) return;
  
  document.getElementById('relation-group').style.display = 'none';
  document.getElementById('delete-btn').style.display = 'block';
  document.getElementById('modal-title').textContent = isArabic ? 'ØªØ¹Ø¯ÙŠÙ„' : 'Edit';
  document.getElementById('modal-icon').textContent = 'âœï¸';
  
  document.getElementById('person-name').value = person.name || '';
  document.querySelector(`input[name="gender"][value="${person.gender}"]`).checked = true;
  document.getElementById('person-birth').value = person.birthDate || '';
  document.getElementById('person-death').value = person.deathDate || '';
  document.getElementById('person-notes').value = person.notes || '';
  
  currentPhoto = person.photo || null;
  updatePhotoPreview();
  
  openModal();
}

function savePerson() {
  const name = document.getElementById('person-name').value.trim();
  if (!name) {
    showToast(isArabic ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…' : 'Please enter a name');
    return;
  }
  
  const gender = document.querySelector('input[name="gender"]:checked').value;
  const birthDate = document.getElementById('person-birth').value;
  const deathDate = document.getElementById('person-death').value;
  const notes = document.getElementById('person-notes').value.trim();
  
  if (editMode && currentPersonId) {
    // ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆØ¬ÙˆØ¯
    const person = familyData.persons[currentPersonId];
    person.name = name;
    person.gender = gender;
    person.birthDate = birthDate;
    person.deathDate = deathDate;
    person.notes = notes;
    person.photo = currentPhoto;
  } else {
    // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯
    const newId = generateId();
    const newPerson = {
      id: newId,
      name,
      gender,
      birthDate,
      deathDate,
      notes,
      photo: currentPhoto,
      fatherId: null,
      motherId: null,
      spouseIds: []
    };
    
    if (addingRelativeTo && selectedRelation) {
      const relative = familyData.persons[addingRelativeTo];
      
      switch (selectedRelation) {
        case 'father':
          newPerson.gender = 'male';
          relative.fatherId = newId;
          break;
          
        case 'mother':
          newPerson.gender = 'female';
          relative.motherId = newId;
          break;
          
        case 'spouse':
          newPerson.spouseIds.push(addingRelativeTo);
          relative.spouseIds.push(newId);
          break;
          
        case 'child':
          // Ø§Ù„Ø§Ø¨Ù†/Ø§Ù„Ø¨Ù†Øª: Ù†Ø±Ø¨Ø·Ù‡ Ø¨Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒØ£Ø¨ Ø£Ùˆ Ø£Ù…
          if (relative.gender === 'male') {
            newPerson.fatherId = addingRelativeTo;
          } else {
            newPerson.motherId = addingRelativeTo;
          }
          break;
          
        case 'sibling':
          // Ø§Ù„Ø£Ø®/Ø§Ù„Ø£Ø®Øª: Ù†Ø´Ø§Ø±Ùƒ Ù†ÙØ³ Ø§Ù„Ø£Ø¨ ÙˆØ§Ù„Ø£Ù…
          newPerson.fatherId = relative.fatherId;
          newPerson.motherId = relative.motherId;
          break;
      }
    }
    
    familyData.persons[newId] = newPerson;
    
    if (!familyData.rootId) {
      familyData.rootId = newId;
    }
  }
  
  closeModal();
  layoutTree();
  renderTree();
  updateStats();
}

function deletePerson() {
  if (!currentPersonId) return;
  
  const msg = isArabic ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø´Ø®ØµØŸ' : 'Delete this person?';
  if (!confirm(msg)) return;
  
  const person = familyData.persons[currentPersonId];
  
  // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
  Object.values(familyData.persons).forEach(p => {
    if (p.fatherId === currentPersonId) p.fatherId = null;
    if (p.motherId === currentPersonId) p.motherId = null;
    p.spouseIds = p.spouseIds.filter(id => id !== currentPersonId);
  });
  
  delete familyData.persons[currentPersonId];
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø°Ø±
  const remaining = Object.keys(familyData.persons);
  if (familyData.rootId === currentPersonId) {
    familyData.rootId = remaining.length > 0 ? remaining[0] : null;
  }
  
  closeModal();
  layoutTree();
  renderTree();
  updateStats();
  showToast(isArabic ? 'ØªÙ… Ø§Ù„Ø­Ø°Ù' : 'Deleted');
}

function selectRelation(relationId) {
  const option = document.querySelector(`.relation-option[data-relation="${relationId}"]`);
  if (option.classList.contains('disabled')) return;
  
  selectedRelation = relationId;
  document.querySelectorAll('.relation-option').forEach(el => {
    el.classList.toggle('selected', el.dataset.relation === relationId);
  });
  
  // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ù†Ø³ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
  const rel = relations.find(r => r.id === relationId);
  if (rel && rel.gender) {
    document.querySelector(`input[name="gender"][value="${rel.gender}"]`).checked = true;
  }
}

// ==================== PHOTO ====================
function handlePhotoUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function(e) {
    currentPhoto = e.target.result;
    updatePhotoPreview();
  };
  reader.readAsDataURL(file);
}

function removePhoto() {
  currentPhoto = null;
  updatePhotoPreview();
  document.getElementById('photo-input').value = '';
}

function updatePhotoPreview() {
  const preview = document.getElementById('photo-preview');
  const removeBtn = document.getElementById('remove-photo-btn');
  
  if (currentPhoto) {
    preview.innerHTML = `<img src="${currentPhoto}" alt="">`;
    removeBtn.style.display = 'block';
  } else {
    preview.innerHTML = '<span class="placeholder">ğŸ‘¤</span>';
    removeBtn.style.display = 'none';
  }
}

// ==================== LAYOUT ====================
function layoutTree() {
  const persons = Object.values(familyData.persons);
  if (persons.length === 0) return;
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª (Ø§Ù„Ø£Ø¬ÙŠØ§Ù„)
  const levels = {};
  const positioned = new Set();
  
  // BFS Ù…Ù† Ø§Ù„Ø¬Ø°Ø±
  function assignLevel(personId, level) {
    if (positioned.has(personId)) return;
    positioned.add(personId);
    
    const person = familyData.persons[personId];
    if (!person) return;
    
    if (!levels[level]) levels[level] = [];
    levels[level].push(personId);
    person._level = level;
    
    // Ø§Ù„Ø¢Ø¨Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø¹Ù„Ù‰
    if (person.fatherId) assignLevel(person.fatherId, level - 1);
    if (person.motherId) assignLevel(person.motherId, level - 1);
    
    // Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø¯Ù†Ù‰
    getChildren(personId).forEach(child => {
      assignLevel(child.id, level + 1);
    });
    
    // Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
    person.spouseIds.forEach(spouseId => {
      if (!positioned.has(spouseId)) {
        assignLevel(spouseId, level);
      }
    });
    
    // Ø§Ù„Ø¥Ø®ÙˆØ© ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
    getSiblings(personId).forEach(sib => {
      if (!positioned.has(sib.id)) {
        assignLevel(sib.id, level);
      }
    });
  }
  
  assignLevel(familyData.rootId, 0);
  
  // ØªØ±ØªÙŠØ¨ Ø£ÙÙ‚ÙŠ
  const levelNums = Object.keys(levels).map(Number).sort((a, b) => a - b);
  const minLevel = Math.min(...levelNums);
  
  const canvasW = document.getElementById('tree-canvas').clientWidth || 800;
  
  levelNums.forEach(lvl => {
    const personsInLevel = levels[lvl];
    const totalW = personsInLevel.length * CARD_W + (personsInLevel.length - 1) * GAP_H;
    const startX = (canvasW - totalW) / 2;
    const y = 80 + (lvl - minLevel) * (CARD_H + GAP_V);
    
    personsInLevel.forEach((pid, idx) => {
      const p = familyData.persons[pid];
      p._x = startX + idx * (CARD_W + GAP_H);
      p._y = y;
    });
  });
}

// ==================== RENDER ====================
function renderTree() {
  const connLayer = document.getElementById('connections-layer');
  const persLayer = document.getElementById('persons-layer');
  
  connLayer.innerHTML = '';
  persLayer.innerHTML = '';
  
  const persons = Object.values(familyData.persons);
  if (persons.length === 0) return;
  
  // Ø±Ø³Ù… Ø§Ù„Ø®Ø·ÙˆØ·
  persons.forEach(person => {
    // Ø®Ø· Ù„Ù„Ø£Ø¨
    if (person.fatherId) {
      const father = familyData.persons[person.fatherId];
      if (father) drawLine(father, person, connLayer);
    }
    // Ø®Ø· Ù„Ù„Ø£Ù…
    if (person.motherId) {
      const mother = familyData.persons[person.motherId];
      if (mother) drawLine(mother, person, connLayer);
    }
    // Ø®Ø· Ù„Ù„Ø£Ø²ÙˆØ§Ø¬
    person.spouseIds.forEach(spId => {
      const spouse = familyData.persons[spId];
      if (spouse && person.id < spId) {
        drawSpouseLine(person, spouse, connLayer);
      }
    });
  });
  
  // Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
  persons.forEach(person => {
    drawCard(person, persLayer);
  });
  
  updateTransform();
  updateUI();
}

function drawLine(parent, child, layer) {
  const x1 = parent._x + CARD_W / 2;
  const y1 = parent._y + CARD_H;
  const x2 = child._x + CARD_W / 2;
  const y2 = child._y;
  
  const midY = (y1 + y2) / 2;
  
  const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
  path.setAttribute('d', `M ${x1} ${y1} L ${x1} ${midY} L ${x2} ${midY} L ${x2} ${y2}`);
  path.setAttribute('stroke', '#475569');
  path.setAttribute('stroke-width', '2');
  path.setAttribute('fill', 'none');
  layer.appendChild(path);
}

function drawSpouseLine(p1, p2, layer) {
  const x1 = p1._x + CARD_W;
  const y1 = p1._y + CARD_H / 2;
  const x2 = p2._x;
  const y2 = p2._y + CARD_H / 2;
  
  const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
  line.setAttribute('x1', x1);
  line.setAttribute('y1', y1);
  line.setAttribute('x2', x2);
  line.setAttribute('y2', y2);
  line.setAttribute('stroke', '#f59e0b');
  line.setAttribute('stroke-width', '2');
  line.setAttribute('stroke-dasharray', '5,5');
  layer.appendChild(line);
  
  // Ø²Ø± + Ø¹Ù„Ù‰ Ø®Ø· Ø§Ù„Ø²ÙˆØ§Ø¬ Ù„Ø¥Ø¶Ø§ÙØ© Ø£Ø¨Ù†Ø§Ø¡ Ù…Ø´ØªØ±ÙƒÙŠÙ†
  const midX = (x1 + x2) / 2;
  const midY = (y1 + y2) / 2 + 20;
  drawAddButton(midX, midY, () => addChildToCouple(p1.id, p2.id), layer);
}

function drawCard(person, layer) {
  const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
  g.setAttribute('transform', `translate(${person._x}, ${person._y})`);
  g.style.cursor = 'pointer';
  
  // Ø§Ù„Ø®Ù„ÙÙŠØ©
  const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
  rect.setAttribute('width', CARD_W);
  rect.setAttribute('height', CARD_H);
  rect.setAttribute('rx', '10');
  rect.setAttribute('fill', '#334155');
  rect.setAttribute('stroke', person.gender === 'female' ? '#ec4899' : '#3b82f6');
  rect.setAttribute('stroke-width', person.deathDate ? '2' : '3');
  if (person.deathDate) rect.setAttribute('stroke-dasharray', '5,3');
  rect.setAttribute('filter', 'url(#shadow)');
  g.appendChild(rect);
  
  // Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø£Ùˆ Ø§Ù„ØµÙˆØ±Ø©
  if (person.photo) {
    const img = document.createElementNS('http://www.w3.org/2000/svg', 'image');
    img.setAttribute('x', CARD_W/2 - 20);
    img.setAttribute('y', 8);
    img.setAttribute('width', 40);
    img.setAttribute('height', 40);
    img.setAttribute('href', person.photo);
    img.setAttribute('clip-path', 'circle(20px at 20px 20px)');
    g.appendChild(img);
  } else {
    const icon = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    icon.setAttribute('x', CARD_W/2);
    icon.setAttribute('y', 35);
    icon.setAttribute('text-anchor', 'middle');
    icon.setAttribute('font-size', '28');
    icon.textContent = person.gender === 'female' ? 'ğŸ‘©' : 'ğŸ‘¨';
    g.appendChild(icon);
  }
  
  // Ø§Ù„Ø§Ø³Ù…
  const name = document.createElementNS('http://www.w3.org/2000/svg', 'text');
  name.setAttribute('x', CARD_W/2);
  name.setAttribute('y', 65);
  name.setAttribute('text-anchor', 'middle');
  name.setAttribute('fill', '#f8fafc');
  name.setAttribute('font-size', '13');
  name.setAttribute('font-weight', '600');
  name.textContent = person.name.length > 12 ? person.name.substring(0, 12) + '..' : person.name;
  g.appendChild(name);
  
  // Ø§Ù„Ø¹Ù…Ø±
  if (person.birthDate) {
    const age = calcAge(person.birthDate, person.deathDate);
    const ageText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    ageText.setAttribute('x', CARD_W/2);
    ageText.setAttribute('y', 80);
    ageText.setAttribute('text-anchor', 'middle');
    ageText.setAttribute('fill', '#94a3b8');
    ageText.setAttribute('font-size', '10');
    ageText.textContent = age + (isArabic ? ' Ø³Ù†Ø©' : ' yrs') + (person.deathDate ? ' âœ' : '');
    g.appendChild(ageText);
  }
  
  g.addEventListener('click', (e) => {
    e.stopPropagation();
    editPerson(person.id);
  });
  
  layer.appendChild(g);
  
  // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ©
  // Ø£Ø¹Ù„Ù‰ - Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†
  drawAddButton(person._x + CARD_W/2, person._y - 15, () => addRelativeTo(person.id), layer);
  // ÙŠÙ…ÙŠÙ† - Ø²ÙˆØ¬/Ø©
  drawAddButton(person._x + CARD_W + 15, person._y + CARD_H/2, () => addRelativeTo(person.id), layer);
  // Ø£Ø³ÙÙ„ - Ø£Ø¨Ù†Ø§Ø¡
  drawAddButton(person._x + CARD_W/2, person._y + CARD_H + 15, () => addRelativeTo(person.id), layer);
}

function drawAddButton(x, y, onClick, layer) {
  const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
  g.setAttribute('transform', `translate(${x - 12}, ${y - 12})`);
  g.style.cursor = 'pointer';
  
  const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
  circle.setAttribute('cx', 12);
  circle.setAttribute('cy', 12);
  circle.setAttribute('r', 12);
  circle.setAttribute('fill', '#1e293b');
  circle.setAttribute('stroke', '#059669');
  circle.setAttribute('stroke-width', '2');
  g.appendChild(circle);
  
  const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
  text.setAttribute('x', 12);
  text.setAttribute('y', 12);
  text.setAttribute('text-anchor', 'middle');
  text.setAttribute('dominant-baseline', 'central');
  text.setAttribute('fill', '#059669');
  text.setAttribute('font-size', '16');
  text.setAttribute('font-weight', 'bold');
  text.textContent = '+';
  g.appendChild(text);
  
  g.addEventListener('click', (e) => {
    e.stopPropagation();
    onClick();
  });
  
  g.addEventListener('mouseenter', () => {
    circle.setAttribute('fill', '#059669');
    text.setAttribute('fill', 'white');
  });
  
  g.addEventListener('mouseleave', () => {
    circle.setAttribute('fill', '#1e293b');
    text.setAttribute('fill', '#059669');
  });
  
  layer.appendChild(g);
}

function addChildToCouple(parent1Id, parent2Id) {
  const p1 = familyData.persons[parent1Id];
  const p2 = familyData.persons[parent2Id];
  
  // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ø¨ ÙˆØ§Ù„Ø£Ù…
  const father = p1.gender === 'male' ? p1 : p2;
  const mother = p1.gender === 'female' ? p1 : p2;
  
  editMode = false;
  addingRelativeTo = null;
  selectedRelation = 'child_of_couple';
  currentPhoto = null;
  
  // Ø­ÙØ¸ Ù…Ø¤Ù‚Øª
  window._coupleChild = { fatherId: father.id, motherId: mother.id };
  
  document.getElementById('relation-group').style.display = 'none';
  document.getElementById('delete-btn').style.display = 'none';
  document.getElementById('modal-title').textContent = isArabic ? 'Ø¥Ø¶Ø§ÙØ© Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©' : 'Add Child';
  document.getElementById('modal-icon').textContent = 'ğŸ‘¶';
  
  resetForm();
  openModal();
}

function calcAge(birth, death) {
  const b = new Date(birth);
  const e = death ? new Date(death) : new Date();
  let age = e.getFullYear() - b.getFullYear();
  if (e.getMonth() < b.getMonth() || (e.getMonth() === b.getMonth() && e.getDate() < b.getDate())) {
    age--;
  }
  return age;
}

// ==================== PAN & ZOOM ====================
function startPan(e) {
  if (e.target.closest('g[style*="cursor: pointer"]')) return;
  isDragging = true;
  dragStartX = e.clientX - panX;
  dragStartY = e.clientY - panY;
}

function doPan(e) {
  if (!isDragging) return;
  panX = e.clientX - dragStartX;
  panY = e.clientY - dragStartY;
  updateTransform();
}

function endPan() { isDragging = false; }

function handleZoom(e) {
  e.preventDefault();
  zoom = Math.max(0.3, Math.min(2, zoom + (e.deltaY > 0 ? -0.1 : 0.1)));
  updateTransform();
  document.getElementById('zoom-level').textContent = Math.round(zoom * 100) + '%';
}

function zoomIn() {
  zoom = Math.min(2, zoom + 0.1);
  updateTransform();
  document.getElementById('zoom-level').textContent = Math.round(zoom * 100) + '%';
}

function zoomOut() {
  zoom = Math.max(0.3, zoom - 0.1);
  updateTransform();
  document.getElementById('zoom-level').textContent = Math.round(zoom * 100) + '%';
}

function fitToScreen() {
  zoom = 1; panX = 0; panY = 0;
  updateTransform();
  document.getElementById('zoom-level').textContent = '100%';
}

function updateTransform() {
  const content = document.getElementById('tree-content');
  content.setAttribute('transform', `translate(${panX}, ${panY}) scale(${zoom})`);
}

let touchStartX, touchStartY;
function handleTouchStart(e) {
  if (e.touches.length === 1) {
    touchStartX = e.touches[0].clientX - panX;
    touchStartY = e.touches[0].clientY - panY;
  }
}
function handleTouchMove(e) {
  if (e.touches.length === 1) {
    e.preventDefault();
    panX = e.touches[0].clientX - touchStartX;
    panY = e.touches[0].clientY - touchStartY;
    updateTransform();
  }
}
function handleTouchEnd() {}

// ==================== SAVE/LOAD ====================
function saveToLocal() {
  localStorage.setItem('familyTree', JSON.stringify(familyData));
  showToast(isArabic ? 'ØªÙ… Ø§Ù„Ø­ÙØ¸' : 'Saved');
}

function loadFromLocal() {
  const saved = localStorage.getItem('familyTree');
  if (saved) {
    familyData = JSON.parse(saved);
    layoutTree();
    renderTree();
    updateStats();
    showToast(isArabic ? 'ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„' : 'Loaded');
  } else {
    showToast(isArabic ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª' : 'No data');
  }
}

function exportAsJSON() {
  const data = JSON.stringify(familyData, null, 2);
  download(data, 'family-tree.json', 'application/json');
}

function importJSON() {
  document.getElementById('import-input').click();
}

function handleImport(e) {
  const file = e.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function(ev) {
    try {
      familyData = JSON.parse(ev.target.result);
      layoutTree();
      renderTree();
      updateStats();
      showToast(isArabic ? 'ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯' : 'Imported');
    } catch {
      showToast(isArabic ? 'Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­' : 'Invalid file');
    }
  };
  reader.readAsText(file);
}

function exportAsPNG() {
  const svg = document.getElementById('tree-canvas');
  const svgData = new XMLSerializer().serializeToString(svg);
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');
  const img = new Image();
  
  canvas.width = svg.clientWidth * 2;
  canvas.height = svg.clientHeight * 2;
  
  img.onload = function() {
    ctx.fillStyle = '#0f172a';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    
    const link = document.createElement('a');
    link.download = 'family-tree.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  };
  
  img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgData)));
}

function exportAsSVG() {
  const svg = document.getElementById('tree-canvas');
  const svgData = new XMLSerializer().serializeToString(svg);
  download(svgData, 'family-tree.svg', 'image/svg+xml');
}

function download(content, filename, type) {
  const blob = new Blob([content], { type });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  a.click();
  URL.revokeObjectURL(url);
}

function clearAll() {
  if (!confirm(isArabic ? 'Ù…Ø³Ø­ Ø§Ù„Ø´Ø¬Ø±Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ' : 'Clear entire tree?')) return;
  familyData = { persons: {}, rootId: null };
  renderTree();
  updateUI();
  updateStats();
  showToast(isArabic ? 'ØªÙ… Ø§Ù„Ù…Ø³Ø­' : 'Cleared');
}

// ==================== UI ====================
function updateUI() {
  const count = Object.keys(familyData.persons).length;
  document.getElementById('empty-state').style.display = count === 0 ? 'flex' : 'none';
  document.getElementById('stats-bar').style.display = count === 0 ? 'none' : 'flex';
}

function updateStats() {
  const persons = Object.values(familyData.persons);
  const males = persons.filter(p => p.gender === 'male').length;
  const females = persons.filter(p => p.gender === 'female').length;
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø¬ÙŠØ§Ù„
  const levels = new Set(persons.map(p => p._level).filter(l => l !== undefined));
  
  document.getElementById('stat-total').textContent = persons.length;
  document.getElementById('stat-males').textContent = males;
  document.getElementById('stat-females').textContent = females;
  document.getElementById('stat-generations').textContent = levels.size || 0;
}

function openModal() {
  document.getElementById('person-modal').classList.add('show');
}

function closeModal() {
  document.getElementById('person-modal').classList.remove('show');
  currentPersonId = null;
  addingRelativeTo = null;
  selectedRelation = null;
  window._coupleChild = null;
}

function resetForm() {
  document.getElementById('person-name').value = '';
  document.querySelector('input[name="gender"][value="male"]').checked = true;
  document.getElementById('person-birth').value = '';
  document.getElementById('person-death').value = '';
  document.getElementById('person-notes').value = '';
  currentPhoto = null;
  updatePhotoPreview();
}

function showToast(msg) {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 2000);
}

function toggleDropdown(id) {
  const dd = document.getElementById(id);
  dd.classList.toggle('open');
  
  setTimeout(() => {
    document.addEventListener('click', function close(e) {
      if (!dd.contains(e.target)) {
        dd.classList.remove('open');
        document.removeEventListener('click', close);
      }
    });
  }, 0);
}

document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeModal();
});

// Override savePerson for couple children
const originalSavePerson = savePerson;
savePerson = function() {
  if (window._coupleChild) {
    const name = document.getElementById('person-name').value.trim();
    if (!name) {
      showToast(isArabic ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…' : 'Please enter name');
      return;
    }
    
    const newId = generateId();
    familyData.persons[newId] = {
      id: newId,
      name,
      gender: document.querySelector('input[name="gender"]:checked').value,
      birthDate: document.getElementById('person-birth').value,
      deathDate: document.getElementById('person-death').value,
      notes: document.getElementById('person-notes').value.trim(),
      photo: currentPhoto,
      fatherId: window._coupleChild.fatherId,
      motherId: window._coupleChild.motherId,
      spouseIds: []
    };
    
    closeModal();
    layoutTree();
    renderTree();
    updateStats();
    return;
  }
  
  originalSavePerson.call(this);
};

init();
</script>

<script>
  window.toolsData = [{"id":"percentage","icon":"ğŸ”¢","name":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©","keywords":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø©ØŒ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®ØµÙ…ØŒ percentage calculator","searchTerms":"Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù†Ø³Ø¨ Ù…Ø¦ÙˆÙŠÙ‡ Ø¨Ø§Ù„Ù…ÙŠØ© Ø¨Ø§Ù„Ù…ÙŠÙ‡ Ø¨Ø§Ù„Ù…Ø¦Ø© Ø¨Ø§Ù„Ù…Ø¦Ù‡ Ø§Ù„Ù…Ø¦ÙˆÙŠÙ‡ Ø®ØµÙ… Ø§Ù„Ø®ØµÙ… ØªØ®ÙÙŠØ¶ Ø§Ù„ØªØ®ÙÙŠØ¶ Ø­Ø³Ù… Ø§Ù„Ø­Ø³Ù… Ø³Ø¹Ø± Ø§Ù„Ø³Ø¹Ø± Ø§ÙˆÙ Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±Ø¶ ØªÙ†Ø²ÙŠÙ„Ø§Øª Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø²ÙŠØ§Ø¯Ø© Ù†Ù‚ØµØ§Ù† Ø§Ù„Ù†Ù‚ØµØ§Ù† ÙØ±Ù‚ Ø§Ù„ÙØ±Ù‚ Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø¨Ø¹ Ù†Øµ Ø§Ù„Ù†Øµ Ø«Ù„Ø« Ø§Ù„Ø«Ù„Ø« percent percentage Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø±Ø¨Ø­ Ø§Ù„Ø±Ø¨Ø­ Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø¶Ø±Ø§ÙŠØ¨ Ù‡Ø§Ù…Ø´ Ø§Ù„Ù‡Ø§Ù…Ø´ ÙƒØ³Ø± Ø§Ù„ÙƒØ³Ø± ÙƒØ³ÙˆØ± Ù‚Ø¨Ù„ Ø¨Ø¹Ø¯ Ø§ØµÙ„ÙŠ Ø§Ù„Ø§ØµÙ„ÙŠ Ø§ØµÙ„ Ø§Ù„Ø§ØµÙ„ ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙƒÙ„ÙØ© Ø¨ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ¹ Ø´Ø±Ø§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¬Ø²Ø¡ Ø§Ù„Ø¬Ø²Ø¡ ÙƒÙ„ Ø§Ù„ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹","category":"calculators","categoryName":"Ø­Ø§Ø³Ø¨Ø§Øª","url":"../../ar/tools/percentage.html"},{"id":"interest-calculator","icon":"ğŸ’°","name":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯","keywords":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ØŒ ÙØ§Ø¦Ø¯Ø© Ø¨Ø³ÙŠØ·Ø©ØŒ ÙØ§Ø¦Ø¯Ø© Ù…Ø±ÙƒØ¨Ø©ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Ø±Ø¶ØŒ interest calculator","searchTerms":"ÙØ§Ø¦Ø¯Ø© Ø§Ù„ÙØ§Ø¦Ø¯Ø© ÙÙˆØ§Ø¦Ø¯ Ø§Ù„ÙÙˆØ§Ø¦Ø¯ ÙØ§ÙŠØ¯Ø© Ø§Ù„ÙØ§ÙŠØ¯Ø© ÙÙˆØ§ÙŠØ¯ Ø¨Ø³ÙŠØ·Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ù…Ø±ÙƒØ¨Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ù…Ø±ÙƒØ¨Ù‡ Ù‚Ø±Ø¶ Ø§Ù„Ù‚Ø±Ø¶ Ù‚Ø±ÙˆØ¶ Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ù„Ø¹ÙˆØ§Ø¦Ø¯ Ø±Ø¨Ø­ Ø§Ù„Ø±Ø¨Ø­ Ø¨Ù†Ùƒ Ø§Ù„Ø¨Ù†Ùƒ Ø¨Ù†ÙˆÙƒ Ø§Ù„Ø¨Ù†ÙˆÙƒ Ù…Ø§Ù„ Ø§Ù„Ù…Ø§Ù„ Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙÙ„ÙˆØ³ Ø§Ù„ÙÙ„ÙˆØ³ Ø±Ø§Ø³ Ø±Ø£Ø³ Ø±Ø£Ø³Ù…Ø§Ù„ Ø³Ù†ÙˆÙŠ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø´Ù‡Ø±ÙŠ Ø§Ù„Ø´Ù‡Ø±ÙŠ ÙŠÙˆÙ…ÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø±Ø¨Ø¹ÙŠ Ù†ØµÙ ØªØ±Ø§ÙƒÙ… Ø§Ù„ØªØ±Ø§ÙƒÙ… ØªØ±Ø§ÙƒÙ…ÙŠ Ø±ØµÙŠØ¯ Ø§Ù„Ø±ØµÙŠØ¯ Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¨Ù„Øº Ø§ØµÙ„ÙŠ Ø§Ù„Ø§ØµÙ„ÙŠ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ø­Ø³Ø¨ interest loan compound simple bank money investment","category":"calculators","categoryName":"Ø­Ø§Ø³Ø¨Ø§Øª","url":"../../ar/tools/interest-calculator.html"},{"id":"loan-calculator","icon":"ğŸ¦","name":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù‚Ø±ÙˆØ¶","keywords":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù‚Ø±ÙˆØ¶ØŒ Ù‚Ø³Ø· Ø´Ù‡Ø±ÙŠØŒ Ø¬Ø¯ÙˆÙ„ Ø³Ø¯Ø§Ø¯ØŒ ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù‚Ø±Ø¶ØŒ loan calculator","searchTerms":"Ù‚Ø±Ø¶ Ø§Ù„Ù‚Ø±Ø¶ Ù‚Ø±ÙˆØ¶ Ø§Ù„Ù‚Ø±ÙˆØ¶ ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø¨Ù†Ùƒ Ø§Ù„Ø¨Ù†Ùƒ Ø¨Ù†ÙˆÙƒ Ù‚Ø³Ø· Ø§Ù„Ù‚Ø³Ø· Ø§Ù‚Ø³Ø§Ø· Ø§Ù„Ø§Ù‚Ø³Ø§Ø· Ø´Ù‡Ø±ÙŠ Ø³Ø¯Ø§Ø¯ Ø¬Ø¯ÙˆÙ„ ÙØ§Ø¦Ø¯Ø© ÙÙˆØ§Ø¦Ø¯ ØªÙ‚Ø³ÙŠØ· Ø³ÙŠØ§Ø±Ø© Ù…Ù†Ø²Ù„ Ø¹Ù‚Ø§Ø± Ø´Ø®ØµÙŠ loan payment installment bank mortgage","category":"calculators","categoryName":"Ø­Ø§Ø³Ø¨Ø§Øª","url":"../../ar/tools/loan-calculator.html"},{"id":"body-calculator","icon":"âš–ï¸","name":"Ø­Ø§Ø³Ø¨Ø© ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø³Ù…","keywords":"Ø­Ø§Ø³Ø¨Ø© BMIØŒ Ù…Ø¤Ø´Ø± ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø³Ù…ØŒ Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØŒ Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ©ØŒ Ù†Ø³Ø¨Ø© Ø§Ù„Ø¯Ù‡ÙˆÙ†","searchTerms":"ÙˆØ²Ù† Ø§Ù„ÙˆØ²Ù† ÙƒØªÙ„Ø© Ø§Ù„ÙƒØªÙ„Ø© Ø¬Ø³Ù… Ø§Ù„Ø¬Ø³Ù… bmi Ø¨ÙŠ Ø§Ù… Ø§ÙŠ Ù…Ø¤Ø´Ø± Ø³Ù…Ù†Ø© Ø§Ù„Ø³Ù…Ù†Ø© Ù†Ø­Ø§ÙØ© Ø¯Ù‡ÙˆÙ† Ø§Ù„Ø¯Ù‡ÙˆÙ† Ø³Ø¹Ø±Ø§Øª Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ø­Ø±Ø§Ø±ÙŠØ© Ø§ÙŠØ¶ Ø§Ù„Ø§ÙŠØ¶ Ù…Ø«Ø§Ù„ÙŠ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ Ø·ÙˆÙ„ Ø§Ù„Ø·ÙˆÙ„ Ø®ØµØ± Ø§Ù„Ø®ØµØ± ÙˆØ±Ùƒ body mass index weight fat calories ideal","category":"calculators","categoryName":"Ø­Ø§Ø³Ø¨Ø§Øª","url":"../../ar/tools/body-calculator.html"},{"id":"age-calculator","icon":"ğŸ‚","name":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…Ø±","keywords":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…Ø±ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ø±ØŒ ÙƒÙ… Ø¹Ù…Ø±ÙŠØŒ Ø§Ù„Ø¨Ø±Ø¬ Ø§Ù„ÙÙ„ÙƒÙŠØŒ Ø¹ÙŠØ¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯","searchTerms":"Ø¹Ù…Ø± Ø§Ù„Ø¹Ù…Ø± Ø¹Ù…Ø±ÙŠ Ø³Ù† Ø§Ù„Ø³Ù† ÙƒÙ… Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ØªØ§Ø±ÙŠØ® Ø¨Ø±Ø¬ Ø§Ù„Ø¨Ø±Ø¬ Ø§Ø¨Ø±Ø§Ø¬ ÙÙ„ÙƒÙŠ Ø²ÙˆØ¯ÙŠØ§Ùƒ Ø³Ù†Ø© Ø´Ù‡Ø± ÙŠÙˆÙ… age birthday birth date zodiac calculate how old","category":"calculators","categoryName":"Ø­Ø§Ø³Ø¨Ø§Øª","url":"../../ar/tools/age-calculator.html"},{"id":"family-tree","icon":"ğŸŒ³","name":"Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©","keywords":"Ø´Ø¬Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©ØŒ Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„Ø©ØŒ Ù†Ø³Ø¨ØŒ Ø³Ù„Ø§Ù„Ø©ØŒ Ø£Ù†Ø³Ø§Ø¨ØŒ Ø¹Ù„Ø§Ù‚Ø§Øª Ø¹Ø§Ø¦Ù„ÙŠØ©ØŒ family tree","searchTerms":"Ø´Ø¬Ø±Ø© Ø¹Ø§Ø¦Ù„Ø© Ø¹Ø§Ø¦Ù„Ù‡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ù‡ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© Ù†Ø³Ø¨ Ø£Ù†Ø³Ø§Ø¨ Ø§Ù„Ø£Ù†Ø³Ø§Ø¨ Ø³Ù„Ø§Ù„Ø© Ø¬Ø¯ Ø¬Ø¯Ø© Ø£Ø¨ Ø£Ù… Ø§Ø¨Ù† Ø§Ø¨Ù†Ø© Ø£Ø® Ø£Ø®Øª Ø¹Ù… Ø¹Ù…Ø© Ø®Ø§Ù„ Ø®Ø§Ù„Ø© Ù‚Ø±Ø§Ø¨Ø© Ù‚Ø±ÙŠØ¨ Ø£Ù‚Ø§Ø±Ø¨ Ø§Ù„Ø£Ù‚Ø§Ø±Ø¨ Ù†Ø³Ù„ Ø°Ø±ÙŠØ© family tree genealogy","category":"everyday","categoryName":"Ø£Ø¯ÙˆØ§Øª ÙŠÙˆÙ…ÙŠØ©","url":"../../ar/tools/family-tree.html"}];
</script>
      </main>
      
      <footer class="main-footer">
        <p>ØµÙÙ†Ø¹ Ø¨Ù€ â¤ï¸ | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2026 Ø¹ÙØ¯Ù‘Ø©</p>
      </footer>
    </div>
  </div>
  
  <!-- Settings Panel -->
  <div class="settings-overlay"></div>
  <div class="settings-panel">
    <div class="settings-header">
      <h2 class="settings-title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <button class="settings-close" aria-label="Close">âœ•</button>
    </div>
    <div class="settings-content">
      <div class="settings-section">
        <div class="settings-section-title">Ø§Ù„Ù„ØºØ©</div>
        <div class="settings-option">
          <button class="settings-btn active" data-lang-btn="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
          <button class="settings-btn " data-lang-btn="en">English</button>
        </div>
      </div>
      <div class="settings-section">
        <div class="settings-section-title">Ø§Ù„Ù…Ø¸Ù‡Ø±</div>
        <div class="settings-option">
          <button class="settings-btn" data-theme-btn="light">â˜€ï¸ ÙØ§ØªØ­</button>
          <button class="settings-btn" data-theme-btn="dark">ğŸŒ™ Ø¯Ø§ÙƒÙ†</button>
          <button class="settings-btn active" data-theme-btn="auto">ğŸ’» ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
        </div>
      </div>
      <div class="settings-section">
        <button class="settings-btn" data-clear-data style="width:100%;justify-content:center;color:var(--error);">
          ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        </button>
      </div>
    </div>
  </div>
  
  <div class="toast"></div>
  <script src="../../assets/js/app.js"></script>
</body>
</html>