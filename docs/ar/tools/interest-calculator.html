<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø© - Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† | Ø¹ÙØ¯Ù‘Ø©</title>
  <meta name="description" content="Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© - Ø§Ø­Ø³Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø©ØŒ Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ØŒ Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø©.">
  <meta name="keywords" content="Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ØŒ ÙØ§Ø¦Ø¯Ø© Ø¨Ø³ÙŠØ·Ø©ØŒ ÙØ§Ø¦Ø¯Ø© Ù…Ø±ÙƒØ¨Ø©ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Ø±Ø¶ØŒ interest calculator">
  <meta name="author" content="Udda">
  <meta name="robots" content="index, follow">
  
  <meta property="og:type" content="website">
  <meta property="og:title" content="Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø© - Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† | Ø¹ÙØ¯Ù‘Ø©">
  <meta property="og:description" content="Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© - Ø§Ø­Ø³Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø©ØŒ Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ØŒ Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø©.">
  <meta property="og:url" content="https://udda.tools/ar/tools/interest-calculator.html">
  <meta property="og:site_name" content="Ø¹ÙØ¯Ù‘Ø©">
  <meta property="og:locale" content="ar_SA">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø© - Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† | Ø¹ÙØ¯Ù‘Ø©">
  <meta name="twitter:description" content="Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© - Ø§Ø­Ø³Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø©ØŒ Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ØŒ Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø©.">
  
  <link rel="alternate" hreflang="ar" href="https://udda.tools/ar/tools/interest-calculator.html">
  <link rel="alternate" hreflang="en" href="https://udda.tools/en/tools/interest-calculator.html">
  <link rel="alternate" hreflang="x-default" href="https://udda.tools/ar/tools/interest-calculator.html">
  <link rel="canonical" href="https://udda.tools/ar/tools/interest-calculator.html">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/udda/assets/css/main.css">
  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯",
    "description": "Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© - Ø§Ø­Ø³Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø©ØŒ Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ØŒ Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ³Ø±Ø¹Ø©.",
    "url": "https://udda.tools/ar/tools/interest-calculator.html",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Any",
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
    "inLanguage": ["ar", "en"],
    "isAccessibleForFree": true
  }
  </script>
</head>
<body data-tool-id="interest-calculator">
  <div class="app-container">
    <div class="sidebar-overlay"></div>
    
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="/udda/ar/" class="logo">
          <div class="logo-icon">ğŸ”§</div>
          <span class="logo-text sidebar-text">Ø¹ÙØ¯Ù‘Ø©</span>
        </a>
      </div>
      
      <div class="sidebar-search">
        <div class="search-input-wrapper">
          <input type="text" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¯Ø§Ø©..." aria-label="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¯Ø§Ø©...">
          <svg class="search-icon" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        
        <a href="/udda/ar/" class="nav-item ">
          <span class="nav-item-icon">ğŸ </span>
          <span class="sidebar-text">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </a>
        <div class="nav-section open">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ§®</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø§Øª</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
            <a href="/udda/ar/tools/percentage.html" class="nav-item ">
              <span class="nav-item-icon">ğŸ”¢</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</span>
            </a>
            <a href="/udda/ar/tools/interest-calculator.html" class="nav-item active">
              <span class="nav-item-icon">ğŸ’°</span>
              <span class="sidebar-text">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯</span>
            </a>
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ”„</span>
              <span class="sidebar-text">Ù…Ø­ÙˆÙ‘Ù„Ø§Øª</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ“</span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª Ù†ØµÙŠØ©</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ“…</span>
              <span class="sidebar-text">ÙˆÙ‚Øª ÙˆØªØ§Ø±ÙŠØ®</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">âš¡</span>
              <span class="sidebar-text">Ù…ÙˆÙ„Ù‘Ø¯Ø§Øª</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ–¼ï¸</span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª ØµÙˆØ±</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ’»</span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª Ù…Ø·ÙˆØ±ÙŠÙ†</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
        <div class="nav-section ">
          <div class="nav-section-title">
            <span>
              <span class="nav-section-icon">ğŸ </span>
              <span class="sidebar-text">Ø£Ø¯ÙˆØ§Øª ÙŠÙˆÙ…ÙŠØ©</span>
            </span>
            <svg class="nav-section-arrow sidebar-text" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="m6 9 6 6 6-6"></path>
            </svg>
          </div>
          <div class="nav-section-items">
          </div>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <button class="sidebar-toggle" aria-label="Toggle sidebar">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
          </svg>
          <span class="sidebar-text">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©</span>
        </button>
      </div>
    </aside>
    
    <div class="main-content">
      <header class="main-header">
        <button class="header-btn mobile-menu-btn" aria-label="Menu">
          <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
        
        <nav class="header-breadcrumb">
          <a href="/udda/ar/" class="breadcrumb-link">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
          <span class="breadcrumb-separator">â€º</span>
          <a href="/udda/ar/category/calculators.html" class="breadcrumb-link">Ø­Ø§Ø³Ø¨Ø§Øª</a>
          <span class="breadcrumb-separator">â€º</span>
          <span class="breadcrumb-current">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯</span>
        </nav>
        
        <div class="header-actions">
          <button class="header-btn" data-favorite-btn aria-label="Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©">â˜†</button>
          <button class="header-btn" onclick="App.shareUrl('Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯')" aria-label="Ù…Ø´Ø§Ø±ÙƒØ©">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
              <polyline points="16 6 12 2 8 6"></polyline>
              <line x1="12" y1="2" x2="12" y2="15"></line>
            </svg>
          </button>
          <button class="header-btn" data-open-settings aria-label="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª">
            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
          </button>
        </div>
      </header>
      
      <main class="page-content">
        <!-- Tool: Interest Calculator | Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ -->
<div class="tool-card">
  <div class="tool-header">
    <div class="tool-icon">ğŸ’°</div>
    <div>
      <h1 class="tool-title">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯</h1>
      <p class="tool-description">Ø§Ø­Ø³Ø¨ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙˆØ§Ù„Ù…Ø±ÙƒØ¨Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©</p>
    </div>
  </div>
  
  <!-- Simple Interest Section -->
  <div class="interest-section">
    <h3 class="section-title">ğŸ“Š Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</h3>
    <div class="calc-row-inline">
      <span class="calc-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ</span>
      <input type="number" class="calc-input-sm" id="simple-principal" placeholder="10000" oninput="calcSimple()">
      <span class="calc-label">Ã— Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙØ§Ø¦Ø¯Ø©</span>
      <input type="number" class="calc-input-sm" id="simple-rate" placeholder="5" oninput="calcSimple()">
      <span class="calc-label">% Ã— Ø§Ù„Ù…Ø¯Ø© (Ø³Ù†ÙˆØ§Øª)</span>
      <input type="number" class="calc-input-sm" id="simple-time" placeholder="3" oninput="calcSimple()">
    </div>
    <div class="results-row">
      <div class="result-box">
        <span class="result-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§Ø¦Ø¯Ø©</span>
        <span class="calc-result" id="simple-interest">â€”</span>
        <div class="result-controls">
          <button class="ctrl-btn" onclick="adjustPrecision('simple-interest', -1)">âˆ’</button>
          <button class="ctrl-btn" onclick="adjustPrecision('simple-interest', 1)">+</button>
          <button class="ctrl-btn" onclick="copyResult('simple-interest')">ğŸ“‹</button>
        </div>
      </div>
      <div class="result-box">
        <span class="result-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</span>
        <span class="calc-result increase" id="simple-total">â€”</span>
        <div class="result-controls">
          <button class="ctrl-btn" onclick="adjustPrecision('simple-total', -1)">âˆ’</button>
          <button class="ctrl-btn" onclick="adjustPrecision('simple-total', 1)">+</button>
          <button class="ctrl-btn" onclick="copyResult('simple-total')">ğŸ“‹</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Compound Interest Section -->
  <div class="interest-section">
    <h3 class="section-title">ğŸ“ˆ Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</h3>
    <div class="calc-row-inline">
      <span class="calc-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ</span>
      <input type="number" class="calc-input-sm" id="compound-principal" placeholder="1000" oninput="calcCompound()">
      <span class="calc-label">Ã— Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙØ§Ø¦Ø¯Ø©</span>
      <input type="number" class="calc-input-sm" id="compound-rate" placeholder="5" oninput="calcCompound()">
      <span class="calc-label">% Ã— Ø§Ù„Ù…Ø¯Ø© (Ø³Ù†ÙˆØ§Øª)</span>
      <input type="number" class="calc-input-sm" id="compound-time" placeholder="10" oninput="calcCompound()">
    </div>
    <div class="calc-row-inline">
      <span class="calc-label">Ø§Ù„ØªØ±ÙƒÙŠØ¨</span>
      <select class="calc-select" id="compound-frequency" onchange="calcCompound()">
        <option value="1">Ø³Ù†ÙˆÙŠ</option>
        <option value="2">Ù†ØµÙ Ø³Ù†ÙˆÙŠ</option>
        <option value="4">Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ</option>
        <option value="12" selected>Ø´Ù‡Ø±ÙŠ</option>
        <option value="365">ÙŠÙˆÙ…ÙŠ</option>
      </select>
    </div>
    
    <!-- Main Results -->
    <div class="main-results" id="main-results" style="display: none;">
      <div class="big-result">
        <span class="big-result-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</span>
        <div class="big-result-row">
          <span class="big-result-value" id="compound-total-big">â€”</span>
          <button class="copy-big-btn" onclick="copyBigResult()" title="Ù†Ø³Ø®">ğŸ“‹</button>
        </div>
      </div>
      <div class="sub-results">
        <div class="sub-result">
          <span class="sub-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§Ø¦Ø¯Ø©</span>
          <span class="sub-value interest-color" id="compound-interest-display">â€”</span>
        </div>
        <div class="sub-result">
          <span class="sub-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ</span>
          <span class="sub-value" id="compound-principal-display">â€”</span>
        </div>
      </div>
      
      <!-- Export Buttons -->
      <div class="export-buttons">
        <button class="export-btn" onclick="exportToExcel()">
          <span class="btn-icon">ğŸ“Š</span>
          <span>ØªØµØ¯ÙŠØ± Excel</span>
        </button>
        <button class="export-btn chart-btn" onclick="downloadChart()">
          <span class="btn-icon">ğŸ“ˆ</span>
          <span>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø®Ø·Ø·</span>
        </button>
        <button class="export-btn secondary" onclick="copyAllData()">
          <span class="btn-icon">ğŸ“‹</span>
          <span>Ù†Ø³Ø® Ø§Ù„ÙƒÙ„</span>
        </button>
      </div>
    </div>
    
    <!-- Chart -->
    <div class="chart-container" id="chart-container" style="display: none;">
      <canvas id="growth-chart"></canvas>
    </div>
    
    <!-- Yearly Table -->
    <div class="table-container" id="table-container" style="display: none;">
      <table class="data-table">
        <thead>
          <tr>
            <th>Ø§Ù„Ø³Ù†Ø©</th>
            <th>Ø±ØµÙŠØ¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</th>
            <th>Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ©</th>
            <th>Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ…Ø©</th>
            <th>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th>
          </tr>
        </thead>
        <tbody id="yearly-table-body">
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- How to Use -->
<div class="how-to-use">
  <h3>ğŸ“– ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
  <p>Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ ÙˆÙ…Ø¹Ø¯Ù„ Ø§Ù„ÙØ§Ø¦Ø¯Ø© ÙˆØ§Ù„Ù…Ø¯Ø©. Ù„Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„ØªØ±ÙƒÙŠØ¨ ÙÙŠ Ø§Ù„Ø³Ù†Ø©.</p>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>

<style>
.interest-section {
  background: var(--bg-tertiary);
  border-radius: var(--border-radius-lg);
  padding: 24px;
  margin-bottom: 20px;
}

.section-title {
  margin: 0 0 20px 0;
  font-size: 1.2rem;
  color: var(--text-primary);
}

.calc-row-inline {
  display: flex;
  align-items: baseline;
  gap: 8px;
  flex-wrap: wrap;
  padding: 16px 0;
  font-size: 1.15rem;
  line-height: 2.2;
}

.calc-label {
  color: var(--text-primary);
}

.calc-input-sm {
  width: 100px;
  padding: 4px 8px;
  background: transparent;
  border: none;
  border-bottom: 2px solid var(--accent-primary);
  border-radius: 0;
  color: var(--accent-primary);
  font-size: 1.15rem;
  font-weight: 600;
  font-family: inherit;
  text-align: center;
  transition: all var(--transition-fast);
}

.calc-input-sm:focus {
  outline: none;
  border-bottom-color: var(--accent-secondary);
  background: rgba(99, 102, 241, 0.05);
}

.calc-input-sm::placeholder {
  color: var(--text-muted);
  font-weight: 400;
}

.calc-select {
  padding: 8px 16px;
  background: var(--bg-secondary);
  border: 2px solid var(--border-color);
  border-radius: var(--border-radius);
  color: var(--text-primary);
  font-size: 1rem;
  font-family: inherit;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.calc-select:focus {
  outline: none;
  border-color: var(--accent-primary);
}

.results-row {
  display: flex;
  gap: 20px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.result-box {
  flex: 1;
  min-width: 200px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
  background: var(--bg-secondary);
  border-radius: var(--border-radius);
}

.result-label {
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.calc-result {
  min-width: 60px;
  padding: 8px 16px;
  background: var(--accent-gradient);
  border-radius: var(--border-radius);
  color: white;
  font-size: 1.3rem;
  font-weight: 700;
  text-align: center;
}

.calc-result.increase {
  background: linear-gradient(135deg, #22c55e, #16a34a);
}

.result-controls {
  display: flex;
  gap: 4px;
  justify-content: center;
}

.ctrl-btn {
  width: 28px;
  height: 28px;
  border: none;
  border-radius: 6px;
  background: var(--bg-tertiary);
  color: var(--text-secondary);
  font-size: 1rem;
  cursor: pointer;
  transition: all var(--transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
}

.ctrl-btn:hover {
  background: var(--accent-primary);
  color: white;
}

/* Main Results Display */
.main-results {
  margin-top: 24px;
  padding: 24px;
  background: var(--bg-secondary);
  border-radius: var(--border-radius-lg);
  text-align: center;
}

.big-result {
  margin-bottom: 16px;
}

.big-result-label {
  display: block;
  font-size: 0.95rem;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.big-result-value {
  font-size: 2.5rem;
  font-weight: 800;
  background: linear-gradient(135deg, #22c55e, #16a34a);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.sub-results {
  display: flex;
  justify-content: center;
  gap: 40px;
  padding-top: 16px;
  border-top: 1px solid var(--border-color);
}

.sub-result {
  text-align: center;
}

.sub-label {
  display: block;
  font-size: 0.85rem;
  color: var(--text-muted);
  margin-bottom: 4px;
}

.sub-value {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--text-primary);
}

.sub-value.interest-color {
  color: #22c55e;
}

/* Big Result Copy Button */
.big-result-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.copy-big-btn {
  width: 40px;
  height: 40px;
  border: none;
  border-radius: 50%;
  background: var(--bg-tertiary);
  color: var(--text-secondary);
  font-size: 1.2rem;
  cursor: pointer;
  transition: all var(--transition-fast);
  display: flex;
  align-items: center;
  justify-content: center;
}

.copy-big-btn:hover {
  background: var(--accent-primary);
  color: white;
  transform: scale(1.1);
}

/* Export Buttons */
.export-buttons {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid var(--border-color);
}

.export-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 24px;
  border: none;
  border-radius: var(--border-radius);
  background: linear-gradient(135deg, #22c55e, #16a34a);
  color: white;
  font-size: 0.95rem;
  font-weight: 600;
  font-family: inherit;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.export-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
}

.export-btn.secondary {
  background: var(--accent-gradient);
}

.export-btn.secondary:hover {
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
}

.export-btn.chart-btn {
  background: linear-gradient(135deg, #f59e0b, #d97706);
}

.export-btn.chart-btn:hover {
  box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
}

.btn-icon {
  font-size: 1.1rem;
}

/* Chart */
.chart-container {
  margin-top: 24px;
  padding: 20px;
  background: var(--bg-secondary);
  border-radius: var(--border-radius-lg);
  height: 320px;
}

/* Table */
.table-container {
  margin-top: 24px;
  overflow-x: auto;
  border-radius: var(--border-radius-lg);
  max-height: 400px;
  overflow-y: auto;
}

.data-table {
  width: 100%;
  border-collapse: collapse;
  background: var(--bg-secondary);
  font-size: 0.95rem;
}

.data-table th,
.data-table td {
  padding: 12px 16px;
  text-align: center;
  border-bottom: 1px solid var(--border-color);
}

.data-table th {
  background: var(--accent-primary);
  color: white;
  font-weight: 600;
  position: sticky;
  top: 0;
  z-index: 1;
}

.data-table tbody tr:hover {
  background: var(--bg-tertiary);
}

.data-table td:first-child {
  font-weight: 600;
  color: var(--accent-primary);
}

.data-table td:last-child {
  font-weight: 700;
  color: var(--text-primary);
}

.interest-cell {
  color: #22c55e !important;
}

@media (max-width: 768px) {
  .calc-input-sm {
    width: 80px;
    font-size: 1rem;
  }
  
  .result-box {
    min-width: 150px;
  }
  
  .calc-result {
    font-size: 1.1rem;
  }
  
  .big-result-value {
    font-size: 2rem;
  }
  
  .sub-results {
    gap: 20px;
  }
  
  .data-table {
    font-size: 0.8rem;
  }
  
  .data-table th,
  .data-table td {
    padding: 8px 6px;
  }
  
  .chart-container {
    height: 250px;
  }
  
  .export-buttons {
    flex-direction: column;
    gap: 10px;
  }
  
  .export-btn {
    width: 100%;
    justify-content: center;
  }
}
</style>

<script>
// Store precision for each result
const interestData = {
  'simple-interest': { raw: null, precision: 2 },
  'simple-total': { raw: null, precision: 2 },
  'compound-interest': { raw: null, precision: 2 },
  'compound-total': { raw: null, precision: 2 }
};

let growthChart = null;
let yearlyDataCache = [];  // Store yearly data for export

function formatNumber(num, precision) {
  if (num === null || isNaN(num)) return 'â€”';
  return num.toFixed(precision);
}

function formatCurrency(num) {
  if (num === null || isNaN(num)) return 'â€”';
  return num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function updateResult(id) {
  const data = interestData[id];
  const el = document.getElementById(id);
  if (el) el.textContent = formatNumber(data.raw, data.precision);
}

function adjustPrecision(id, delta) {
  const data = interestData[id];
  if (data.raw === null) return;
  data.precision = Math.max(0, Math.min(10, data.precision + delta));
  updateResult(id);
}

function copyResult(id) {
  const data = interestData[id];
  if (data.raw === null) return;
  navigator.clipboard.writeText(data.raw.toFixed(data.precision)).then(() => {
    App.showToast(App.state.lang === 'ar' ? 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!' : 'Copied!');
  });
}

// Simple Interest: I = P Ã— r Ã— t
function calcSimple() {
  const P = parseFloat(document.getElementById('simple-principal').value);
  const r = parseFloat(document.getElementById('simple-rate').value) / 100;
  const t = parseFloat(document.getElementById('simple-time').value);
  
  if (!isNaN(P) && !isNaN(r) && !isNaN(t)) {
    const interest = P * r * t;
    const total = P + interest;
    
    interestData['simple-interest'].raw = interest;
    interestData['simple-total'].raw = total;
  } else {
    interestData['simple-interest'].raw = null;
    interestData['simple-total'].raw = null;
  }
  
  updateResult('simple-interest');
  updateResult('simple-total');
}

// Compound Interest: A = P Ã— (1 + r)^(nÃ—t)
function calcCompound() {
  const P = parseFloat(document.getElementById('compound-principal').value);
  const r = parseFloat(document.getElementById('compound-rate').value) / 100;
  const t = parseInt(document.getElementById('compound-time').value);
  const n = parseFloat(document.getElementById('compound-frequency').value);
  
  if (!isNaN(P) && !isNaN(r) && !isNaN(t) && !isNaN(n) && P > 0 && t > 0) {
    const total = P * Math.pow(1 + r, n * t);
    const interest = total - P;
    
    interestData['compound-interest'].raw = interest;
    interestData['compound-total'].raw = total;
    
    // Update main display
    document.getElementById('main-results').style.display = 'block';
    document.getElementById('compound-total-big').textContent = '$' + formatCurrency(total);
    document.getElementById('compound-interest-display').textContent = '$' + formatCurrency(interest);
    document.getElementById('compound-principal-display').textContent = '$' + formatCurrency(P);
    
    // Generate yearly data and update chart/table
    generateYearlyData(P, r, n, t);
    
    document.getElementById('chart-container').style.display = 'block';
    document.getElementById('table-container').style.display = 'block';
  } else {
    interestData['compound-interest'].raw = null;
    interestData['compound-total'].raw = null;
    
    document.getElementById('main-results').style.display = 'none';
    document.getElementById('chart-container').style.display = 'none';
    document.getElementById('table-container').style.display = 'none';
  }
}

function generateYearlyData(P, r, n, years) {
  const yearlyData = [];
  let balance = P;
  let totalInterest = 0;
  
  for (let year = 1; year <= years; year++) {
    const startBalance = balance;
    const periodsThisYear = n;
    const endBalance = startBalance * Math.pow(1 + r, periodsThisYear);
    const yearInterest = endBalance - startBalance;
    totalInterest += yearInterest;
    
    yearlyData.push({
      year,
      startBalance,
      yearInterest,
      totalInterest,
      endBalance
    });
    
    balance = endBalance;
  }
  
  yearlyDataCache = yearlyData;  // Cache for export
  
  updateChart(yearlyData, P);
  updateTable(yearlyData);
}

function updateChart(data, principal) {
  const ctx = document.getElementById('growth-chart').getContext('2d');
  
  const labels = data.map(d => d.year);
  const balances = data.map(d => d.endBalance);
  const principalLine = data.map(() => principal);
  
  if (growthChart) {
    growthChart.destroy();
  }
  
  const isArabic = App.state.lang === 'ar';
  
  // Detect current theme
  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
  
  // Colors based on theme
  const textColor = isDark ? '#E5E7EB' : '#374151';
  const gridColor = isDark ? '#374151' : '#E5E7EB';
  const bgColor = isDark ? '#1F2937' : '#FFFFFF';
  
  growthChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [
        {
          label: isArabic ? 'Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ' : 'End Balance',
          data: balances,
          backgroundColor: 'rgba(34, 197, 94, 0.85)',
          borderColor: 'rgba(22, 163, 74, 1)',
          borderWidth: 2,
          borderRadius: 6,
          order: 2
        },
        {
          label: isArabic ? 'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ' : 'Principal',
          data: principalLine,
          type: 'line',
          borderColor: isDark ? 'rgba(129, 140, 248, 1)' : 'rgba(99, 102, 241, 1)',
          borderWidth: 3,
          borderDash: [8, 4],
          fill: false,
          pointRadius: 0,
          order: 1
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'bottom',
          rtl: isArabic,
          labels: {
            color: textColor,
            padding: 20,
            font: { family: 'inherit', size: 13, weight: '600' }
          }
        },
        tooltip: {
          rtl: isArabic,
          backgroundColor: isDark ? 'rgba(255, 255, 255, 0.95)' : 'rgba(17, 24, 39, 0.95)',
          titleColor: isDark ? '#1F2937' : '#FFFFFF',
          bodyColor: isDark ? '#374151' : '#E5E7EB',
          titleFont: { size: 14, weight: '600' },
          bodyFont: { size: 13 },
          padding: 12,
          callbacks: {
            label: function(context) {
              return context.dataset.label + ': $' + context.raw.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            }
          }
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: isArabic ? 'Ø§Ù„Ø³Ù†Ø©' : 'Year',
            color: textColor,
            font: { size: 13, weight: '600' }
          },
          grid: { display: false },
          ticks: { 
            color: textColor,
            font: { size: 12, weight: '500' }
          }
        },
        y: {
          title: {
            display: true,
            text: isArabic ? 'Ø§Ù„Ù…Ø¨Ù„Øº ($)' : 'Amount ($)',
            color: textColor,
            font: { size: 13, weight: '600' }
          },
          grid: {
            color: gridColor
          },
          ticks: {
            color: textColor,
            font: { size: 12, weight: '500' },
            callback: function(value) {
              if (value >= 1000000) return '$' + (value/1000000).toFixed(1) + 'M';
              if (value >= 1000) return '$' + (value/1000).toFixed(0) + 'K';
              return '$' + value.toLocaleString();
            }
          }
        }
      }
    }
  });
}

function updateTable(data) {
  const tbody = document.getElementById('yearly-table-body');
  tbody.innerHTML = '';
  
  data.forEach(row => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${row.year}</td>
      <td>$${formatCurrency(row.startBalance)}</td>
      <td class="interest-cell">$${formatCurrency(row.yearInterest)}</td>
      <td class="interest-cell">$${formatCurrency(row.totalInterest)}</td>
      <td>$${formatCurrency(row.endBalance)}</td>
    `;
    tbody.appendChild(tr);
  });
}

// Watch for theme changes and update chart
const themeObserver = new MutationObserver((mutations) => {
  mutations.forEach((mutation) => {
    if (mutation.attributeName === 'data-theme' && yearlyDataCache.length > 0) {
      const P = parseFloat(document.getElementById('compound-principal').value);
      updateChart(yearlyDataCache, P);
    }
  });
});
themeObserver.observe(document.documentElement, { attributes: true });

// Copy big result
function copyBigResult() {
  const total = interestData['compound-total'].raw;
  if (total === null) return;
  
  navigator.clipboard.writeText(total.toFixed(2)).then(() => {
    App.showToast(App.state.lang === 'ar' ? 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!' : 'Copied!');
  });
}

// Export to Excel with chart image embedded using ExcelJS
async function exportToExcel() {
  if (yearlyDataCache.length === 0) return;
  
  const isArabic = App.state.lang === 'ar';
  const P = parseFloat(document.getElementById('compound-principal').value);
  const r = parseFloat(document.getElementById('compound-rate').value);
  const t = parseInt(document.getElementById('compound-time').value);
  const freq = document.getElementById('compound-frequency');
  const freqText = freq.options[freq.selectedIndex].text;
  
  // Create workbook
  const workbook = new ExcelJS.Workbook();
  workbook.creator = 'Udda Tools';
  workbook.created = new Date();
  
  const sheetName = isArabic ? 'Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©' : 'Compound Interest';
  const worksheet = workbook.addWorksheet(sheetName);
  
  // Set RTL for Arabic
  if (isArabic) {
    worksheet.views = [{ rightToLeft: true }];
  }
  
  // Title
  worksheet.mergeCells('A1:E1');
  const titleCell = worksheet.getCell('A1');
  titleCell.value = isArabic ? 'Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©' : 'Compound Interest Calculator';
  titleCell.font = { size: 18, bold: true, color: { argb: 'FF6366F1' } };
  titleCell.alignment = { horizontal: 'center', vertical: 'middle' };
  worksheet.getRow(1).height = 30;
  
  // Summary section
  const summaryData = [
    [isArabic ? 'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ' : 'Principal', P],
    [isArabic ? 'Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙØ§Ø¦Ø¯Ø©' : 'Interest Rate', r + '%'],
    [isArabic ? 'Ø§Ù„Ù…Ø¯Ø© (Ø³Ù†ÙˆØ§Øª)' : 'Time (years)', t],
    [isArabic ? 'Ø§Ù„ØªØ±ÙƒÙŠØ¨' : 'Compound', freqText],
  ];
  
  summaryData.forEach((row, i) => {
    const rowNum = i + 3;
    worksheet.getCell(`A${rowNum}`).value = row[0];
    worksheet.getCell(`A${rowNum}`).font = { bold: true };
    worksheet.getCell(`B${rowNum}`).value = row[1];
  });
  
  // Results section with background
  worksheet.getCell('A8').value = isArabic ? 'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ' : 'Total Amount';
  worksheet.getCell('A8').font = { bold: true, size: 12 };
  worksheet.getCell('B8').value = interestData['compound-total'].raw;
  worksheet.getCell('B8').numFmt = '$#,##0.00';
  worksheet.getCell('B8').font = { bold: true, size: 14, color: { argb: 'FF22C55E' } };
  
  worksheet.getCell('A9').value = isArabic ? 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§Ø¦Ø¯Ø©' : 'Total Interest';
  worksheet.getCell('A9').font = { bold: true, size: 12 };
  worksheet.getCell('B9').value = interestData['compound-interest'].raw;
  worksheet.getCell('B9').numFmt = '$#,##0.00';
  worksheet.getCell('B9').font = { bold: true, size: 14, color: { argb: 'FF22C55E' } };
  
  // Table headers
  const headerRow = 12;
  const headers = isArabic 
    ? ['Ø§Ù„Ø³Ù†Ø©', 'Ø±ØµÙŠØ¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©', 'Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ©', 'Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ…Ø©', 'Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ']
    : ['Year', 'Start Balance', 'Yearly Interest', 'Accumulated Interest', 'End Balance'];
  
  headers.forEach((header, i) => {
    const cell = worksheet.getCell(headerRow, i + 1);
    cell.value = header;
    cell.font = { bold: true, color: { argb: 'FFFFFFFF' } };
    cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF6366F1' } };
    cell.alignment = { horizontal: 'center' };
    cell.border = {
      top: { style: 'thin' },
      bottom: { style: 'thin' },
      left: { style: 'thin' },
      right: { style: 'thin' }
    };
  });
  
  // Table data
  yearlyDataCache.forEach((row, i) => {
    const rowNum = headerRow + 1 + i;
    worksheet.getCell(rowNum, 1).value = row.year;
    worksheet.getCell(rowNum, 1).alignment = { horizontal: 'center' };
    worksheet.getCell(rowNum, 2).value = row.startBalance;
    worksheet.getCell(rowNum, 3).value = row.yearInterest;
    worksheet.getCell(rowNum, 4).value = row.totalInterest;
    worksheet.getCell(rowNum, 5).value = row.endBalance;
    
    // Format currency and borders
    for (let col = 1; col <= 5; col++) {
      const cell = worksheet.getCell(rowNum, col);
      if (col > 1) cell.numFmt = '$#,##0.00';
      cell.border = {
        top: { style: 'thin', color: { argb: 'FFE5E7EB' } },
        bottom: { style: 'thin', color: { argb: 'FFE5E7EB' } },
        left: { style: 'thin', color: { argb: 'FFE5E7EB' } },
        right: { style: 'thin', color: { argb: 'FFE5E7EB' } }
      };
      
      // Alternate row colors
      if (i % 2 === 0) {
        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFF9FAFB' } };
      }
    }
  });
  
  // Set column widths
  worksheet.columns = [
    { width: 12 },
    { width: 18 },
    { width: 18 },
    { width: 22 },
    { width: 18 }
  ];
  
  // Add chart image
  const canvas = document.getElementById('growth-chart');
  const tempCanvas = document.createElement('canvas');
  const tempCtx = tempCanvas.getContext('2d');
  tempCanvas.width = canvas.width;
  tempCanvas.height = canvas.height;
  tempCtx.fillStyle = '#ffffff';
  tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
  tempCtx.drawImage(canvas, 0, 0);
  
  const chartImageBase64 = tempCanvas.toDataURL('image/png').split(',')[1];
  
  const imageId = workbook.addImage({
    base64: chartImageBase64,
    extension: 'png',
  });
  
  const chartStartRow = headerRow + yearlyDataCache.length + 3;
  worksheet.addImage(imageId, {
    tl: { col: 0, row: chartStartRow },
    ext: { width: 600, height: 300 }
  });
  
  // Generate and download
  const buffer = await workbook.xlsx.writeBuffer();
  const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
  const url = URL.createObjectURL(blob);
  
  const link = document.createElement('a');
  link.href = url;
  link.download = isArabic ? 'Ø­Ø§Ø³Ø¨Ø©_Ø§Ù„ÙØ§Ø¦Ø¯Ø©_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.xlsx' : 'compound_interest_calculator.xlsx';
  link.click();
  
  URL.revokeObjectURL(url);
  
  App.showToast(isArabic ? 'ØªÙ… Ø§Ù„ØªØµØ¯ÙŠØ± Ù…Ø¹ Ø§Ù„Ù…Ø®Ø·Ø·!' : 'Exported with chart!');
}

// Copy all data to clipboard
function copyAllData() {
  if (yearlyDataCache.length === 0) return;
  
  const isArabic = App.state.lang === 'ar';
  const P = parseFloat(document.getElementById('compound-principal').value);
  const r = parseFloat(document.getElementById('compound-rate').value);
  const t = parseInt(document.getElementById('compound-time').value);
  const freq = document.getElementById('compound-frequency');
  const freqText = freq.options[freq.selectedIndex].text;
  
  let text = '';
  
  // Title and summary
  text += (isArabic ? 'Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©\n' : 'Compound Interest Calculator\n');
  text += 'â•'.repeat(40) + '\n\n';
  
  text += (isArabic ? 'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£ØµÙ„ÙŠ: ' : 'Principal: ') + '$' + formatCurrency(P) + '\n';
  text += (isArabic ? 'Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙØ§Ø¦Ø¯Ø©: ' : 'Interest Rate: ') + r + '%\n';
  text += (isArabic ? 'Ø§Ù„Ù…Ø¯Ø©: ' : 'Time: ') + t + (isArabic ? ' Ø³Ù†ÙˆØ§Øª\n' : ' years\n');
  text += (isArabic ? 'Ø§Ù„ØªØ±ÙƒÙŠØ¨: ' : 'Compound: ') + freqText + '\n\n';
  
  text += 'â•'.repeat(40) + '\n';
  text += (isArabic ? 'Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ' : 'Total Amount: ') + '$' + formatCurrency(interestData['compound-total'].raw) + '\n';
  text += (isArabic ? 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§Ø¦Ø¯Ø©: ' : 'Total Interest: ') + '$' + formatCurrency(interestData['compound-interest'].raw) + '\n';
  text += 'â•'.repeat(40) + '\n\n';
  
  // Table
  const headers = isArabic 
    ? ['Ø§Ù„Ø³Ù†Ø©', 'Ø±ØµÙŠØ¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©', 'Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ©', 'Ø§Ù„ÙØ§Ø¦Ø¯Ø© Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ…Ø©', 'Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ']
    : ['Year', 'Start Balance', 'Yearly Interest', 'Accumulated', 'End Balance'];
  
  text += headers.join('\t') + '\n';
  text += 'â”€'.repeat(60) + '\n';
  
  yearlyDataCache.forEach(row => {
    text += [
      row.year,
      '$' + formatCurrency(row.startBalance),
      '$' + formatCurrency(row.yearInterest),
      '$' + formatCurrency(row.totalInterest),
      '$' + formatCurrency(row.endBalance)
    ].join('\t') + '\n';
  });
  
  navigator.clipboard.writeText(text).then(() => {
    App.showToast(isArabic ? 'ØªÙ… Ù†Ø³Ø® ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!' : 'All data copied!');
  });
}

// Download chart as PNG image
function downloadChart() {
  if (!growthChart) return;
  
  const isArabic = App.state.lang === 'ar';
  const canvas = document.getElementById('growth-chart');
  
  // Create a temporary canvas with white background
  const tempCanvas = document.createElement('canvas');
  const tempCtx = tempCanvas.getContext('2d');
  tempCanvas.width = canvas.width;
  tempCanvas.height = canvas.height;
  
  // Fill white background
  tempCtx.fillStyle = '#ffffff';
  tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
  
  // Draw the chart on top
  tempCtx.drawImage(canvas, 0, 0);
  
  // Convert to image and download
  const link = document.createElement('a');
  link.download = isArabic ? 'Ù…Ø®Ø·Ø·_Ø§Ù„ÙØ§Ø¦Ø¯Ø©_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.png' : 'compound_interest_chart.png';
  link.href = tempCanvas.toDataURL('image/png');
  link.click();
  
  App.showToast(isArabic ? 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø®Ø·Ø·!' : 'Chart downloaded!');
}
</script>

<script>
  window.toolsData = [{"id":"percentage","icon":"ğŸ”¢","name":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©","keywords":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø©ØŒ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®ØµÙ…ØŒ percentage calculator","searchTerms":"Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù†Ø³Ø¨ Ù…Ø¦ÙˆÙŠÙ‡ Ø¨Ø§Ù„Ù…ÙŠØ© Ø¨Ø§Ù„Ù…ÙŠÙ‡ Ø¨Ø§Ù„Ù…Ø¦Ø© Ø¨Ø§Ù„Ù…Ø¦Ù‡ Ø§Ù„Ù…Ø¦ÙˆÙŠÙ‡ Ø®ØµÙ… Ø§Ù„Ø®ØµÙ… ØªØ®ÙÙŠØ¶ Ø§Ù„ØªØ®ÙÙŠØ¶ Ø­Ø³Ù… Ø§Ù„Ø­Ø³Ù… Ø³Ø¹Ø± Ø§Ù„Ø³Ø¹Ø± Ø§ÙˆÙ Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±Ø¶ ØªÙ†Ø²ÙŠÙ„Ø§Øª Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø²ÙŠØ§Ø¯Ø© Ù†Ù‚ØµØ§Ù† Ø§Ù„Ù†Ù‚ØµØ§Ù† ÙØ±Ù‚ Ø§Ù„ÙØ±Ù‚ Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø¨Ø¹ Ù†Øµ Ø§Ù„Ù†Øµ Ø«Ù„Ø« Ø§Ù„Ø«Ù„Ø« percent percentage Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø±Ø¨Ø­ Ø§Ù„Ø±Ø¨Ø­ Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø¶Ø±Ø§ÙŠØ¨ Ù‡Ø§Ù…Ø´ Ø§Ù„Ù‡Ø§Ù…Ø´ ÙƒØ³Ø± Ø§Ù„ÙƒØ³Ø± ÙƒØ³ÙˆØ± Ù‚Ø¨Ù„ Ø¨Ø¹Ø¯ Ø§ØµÙ„ÙŠ Ø§Ù„Ø§ØµÙ„ÙŠ Ø§ØµÙ„ Ø§Ù„Ø§ØµÙ„ ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙƒÙ„ÙØ© Ø¨ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ¹ Ø´Ø±Ø§Ø¡ Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¬Ø²Ø¡ Ø§Ù„Ø¬Ø²Ø¡ ÙƒÙ„ Ø§Ù„ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹","category":"calculators","categoryName":"Ø­Ø§Ø³Ø¨Ø§Øª","url":"/udda/ar/tools/percentage.html"},{"id":"interest-calculator","icon":"ğŸ’°","name":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯","keywords":"Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙÙˆØ§Ø¦Ø¯ØŒ ÙØ§Ø¦Ø¯Ø© Ø¨Ø³ÙŠØ·Ø©ØŒ ÙØ§Ø¦Ø¯Ø© Ù…Ø±ÙƒØ¨Ø©ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚Ø±Ø¶ØŒ interest calculator","searchTerms":"ÙØ§Ø¦Ø¯Ø© Ø§Ù„ÙØ§Ø¦Ø¯Ø© ÙÙˆØ§Ø¦Ø¯ Ø§Ù„ÙÙˆØ§Ø¦Ø¯ ÙØ§ÙŠØ¯Ø© Ø§Ù„ÙØ§ÙŠØ¯Ø© ÙÙˆØ§ÙŠØ¯ Ø¨Ø³ÙŠØ·Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ù…Ø±ÙƒØ¨Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ù…Ø±ÙƒØ¨Ù‡ Ù‚Ø±Ø¶ Ø§Ù„Ù‚Ø±Ø¶ Ù‚Ø±ÙˆØ¶ Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ù„Ø¹ÙˆØ§Ø¦Ø¯ Ø±Ø¨Ø­ Ø§Ù„Ø±Ø¨Ø­ Ø¨Ù†Ùƒ Ø§Ù„Ø¨Ù†Ùƒ Ø¨Ù†ÙˆÙƒ Ø§Ù„Ø¨Ù†ÙˆÙƒ Ù…Ø§Ù„ Ø§Ù„Ù…Ø§Ù„ Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙÙ„ÙˆØ³ Ø§Ù„ÙÙ„ÙˆØ³ Ø±Ø§Ø³ Ø±Ø£Ø³ Ø±Ø£Ø³Ù…Ø§Ù„ Ø³Ù†ÙˆÙŠ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø´Ù‡Ø±ÙŠ Ø§Ù„Ø´Ù‡Ø±ÙŠ ÙŠÙˆÙ…ÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø±Ø¨Ø¹ÙŠ Ù†ØµÙ ØªØ±Ø§ÙƒÙ… Ø§Ù„ØªØ±Ø§ÙƒÙ… ØªØ±Ø§ÙƒÙ…ÙŠ Ø±ØµÙŠØ¯ Ø§Ù„Ø±ØµÙŠØ¯ Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¨Ù„Øº Ø§ØµÙ„ÙŠ Ø§Ù„Ø§ØµÙ„ÙŠ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø³Ø¨Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ø­Ø³Ø¨ interest loan compound simple bank money investment","category":"calculators","categoryName":"Ø­Ø§Ø³Ø¨Ø§Øª","url":"/udda/ar/tools/interest-calculator.html"}];
</script>
      </main>
      
      <footer class="main-footer">
        <p>ØµÙÙ†Ø¹ Ø¨Ù€ â¤ï¸ | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2026 Ø¹ÙØ¯Ù‘Ø©</p>
      </footer>
    </div>
  </div>
  
  <!-- Settings Panel -->
  <div class="settings-overlay"></div>
  <div class="settings-panel">
    <div class="settings-header">
      <h2 class="settings-title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <button class="settings-close" aria-label="Close">âœ•</button>
    </div>
    <div class="settings-content">
      <div class="settings-section">
        <div class="settings-section-title">Ø§Ù„Ù„ØºØ©</div>
        <div class="settings-option">
          <button class="settings-btn active" data-lang-btn="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
          <button class="settings-btn " data-lang-btn="en">English</button>
        </div>
      </div>
      <div class="settings-section">
        <div class="settings-section-title">Ø§Ù„Ù…Ø¸Ù‡Ø±</div>
        <div class="settings-option">
          <button class="settings-btn" data-theme-btn="light">â˜€ï¸ ÙØ§ØªØ­</button>
          <button class="settings-btn" data-theme-btn="dark">ğŸŒ™ Ø¯Ø§ÙƒÙ†</button>
          <button class="settings-btn active" data-theme-btn="auto">ğŸ’» ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
        </div>
      </div>
      <div class="settings-section">
        <button class="settings-btn" data-clear-data style="width:100%;justify-content:center;color:var(--error);">
          ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        </button>
      </div>
    </div>
  </div>
  
  <div class="toast"></div>
  <script src="/udda/assets/js/app.js"></script>
</body>
</html>